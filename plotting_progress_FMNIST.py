import csv

import random
import matplotlib.pyplot as plt
from matplotlib.pyplot import figure
import numpy as np

# Typing
import typing
from typing import TypeVar, Generic
from collections.abc import Callable

from tqdm import tqdm
from collections import namedtuple
import statistics
import dataclasses
from dataclasses import dataclass
from tensorflow.keras.optimizers import Adam
from tensorflow.keras import datasets, layers, models
import tensorflow as tf

from matplotlib.backends.backend_pdf import PdfPages

# cd Documents/
# cd populationDescent/
# python3 -m venv ~/venv-metal
# source ~/venv-metal/bin/activate
# python3 -m plotting_progress_FMNIST




# ## ESGD
# # seed 1
# ema_ESGD15_s1 = [0.7147568140029907, 0.7147568140029907, 0.7063239600372315, 0.6904548344116211, 0.6737380081016541, 0.6529779560326385, 0.6312089610408707, 0.6110588607684639, 0.5913711296059967, 0.572636624606098, 0.5552297108408617, 0.5392673656436927, 0.5238285007548148, 0.5087118442230059, 0.4956699083101123, 0.48244700060707657, 0.46923594914217887, 0.45864946948713153, 0.44770697970890483, 0.4363916123006059, 0.4253704713428003, 0.4155497089222654, 0.4061756981702671, 0.3984000114117884, 0.38980988669826, 0.3817943898096688, 0.3738245924259729, 0.36680000767697457, 0.36022366800894945, 0.35444774962476444, 0.3475625654454072, 0.3411030203457212, 0.3351495013614478, 0.3299197999149545, 0.3247554833701239, 0.32005707379558557, 0.31582810273270795, 0.3117660646018474, 0.30849209666404925, 0.30568624790806, 0.3026341200616815, 0.29921485983135027, 0.2960857052815114, 0.2940475748803158, 0.29156016368859466, 0.28966137870544306, 0.2875035294758747, 0.28509831545479325, 0.28341998261088636, 0.2811936787081466, 0.2796161113505995, 0.27853373191643677, 0.2782309327044093, 0.276636747925103, 0.2746382516222778, 0.27277284675576535, 0.27078584412221535, 0.269158627746264, 0.2677651829413413, 0.26762456534729945, 0.26611578773999106, 0.2649905692608108, 0.26415705728807604, 0.26383652404080526, 0.26298465265688925, 0.26200204312316444, 0.261466875126766, 0.26094804889453066, 0.2600120017346079, 0.2588758463462891, 0.25870860681599694, 0.2582846699434488, 0.2589567838988872, 0.2585021208717381, 0.2577046227068265, 0.25628141042088504, 0.2563630747600946, 0.2564744426790971, 0.25531082490063595, 0.25657403019228775, 0.25644145208322283, 0.25716294991365024, 0.2566142325609113, 0.25601394599877464, 0.25603160533728603, 0.25647128072103026, 0.25580476763534693, 0.25641680803079736, 0.255119834597522, 0.2555565920921689, 0.25502196578614644, 0.2548081960526055, 0.25487950303735846, 0.2541135944382773, 0.25360400719312665, 0.25336073130310627, 0.2525886586863493, 0.2526234178711797, 0.2547469616851054, 0.2543839726609745, 0.25512860971952306, 0.25458916766045836, 0.25470061674772215, 0.25463990735285147, 0.255846604698354, 0.2564842093886024, 0.25657448239991837, 0.2569123917377273, 0.2573832137736332, 0.2581938688152419, 0.25931252904743435, 0.25923952245662046, 0.25893585069611164, 0.2584748849931463, 0.2584275877746735, 0.25837928839976737, 0.259971761379735, 0.2601907520479825, 0.26102391192318797, 0.26074930711926636, 0.2596799114806201, 0.25958216522181743, 0.2589779667488758, 0.26051912302780367, 0.26099575766391947, 0.26154166156471426, 0.26168427492637025, 0.26228143535249165, 0.2634330910139626, 0.26415685951113815, 0.2642197016137849, 0.26527442789357997, 0.26713236922277894, 0.26750524124074476, 0.2682328776148125, 0.2706172858500926, 0.2720228062532349, 0.27360334275561604, 0.2730110239159885, 0.2723750535796723, 0.2719499425855852]
# x_ESGD15_s1 = [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000, 53500, 54000, 54500, 55000, 55500, 56000, 56500, 57000, 57500, 58000, 58500, 59000, 59500, 60000, 60500, 61000, 61500, 62000, 62500, 63000, 63500, 64000, 64500, 65000, 65500, 66000, 66500, 67000, 67500, 68000, 68500, 69000, 69500, 70000]
# history_ESGD15_s1 = [0.7147568140029907, 0.6304282743453979, 0.5476327037811279, 0.5232865713119507, 0.466137487411499, 0.4352880061149597, 0.429707958316803, 0.4141815491437912, 0.40402607960700987, 0.39856748695373534, 0.39560625886917117, 0.3848787167549133, 0.3726619354367256, 0.37829248509407043, 0.36344083127975463, 0.35033648595809935, 0.3633711525917053, 0.3492245717048645, 0.3345533056259155, 0.32618020272254944, 0.3271628471374512, 0.3218096014022827, 0.3284188305854797, 0.3124987642765045, 0.3096549178123474, 0.30209641597270964, 0.30357874493598935, 0.3010366109967232, 0.302464484167099, 0.28559590783119204, 0.2829671144485474, 0.2815678305029869, 0.2828524868965149, 0.2782766344666481, 0.2777713876247406, 0.27776736316680906, 0.27520772142410277, 0.2790263852238655, 0.2804336091041565, 0.2751649694442749, 0.26844151775836944, 0.267923314332962, 0.2757044012695551, 0.26917346296310424, 0.27257231385707853, 0.2680828864097595, 0.2634513892650604, 0.2683149870157242, 0.26115694358348845, 0.26541800513267516, 0.26879231700897216, 0.27550573979616166, 0.26228908491134645, 0.2566517848968506, 0.2559842029571533, 0.2529028204202652, 0.2545136803627014, 0.25522417969703676, 0.26635900700092313, 0.2525367892742157, 0.25486360294818877, 0.25665544953346253, 0.26095172481536866, 0.2553178102016449, 0.2531585573196411, 0.25665036315917966, 0.25627861280441283, 0.25158757729530334, 0.24865044785141946, 0.2572034510433674, 0.25446923809051514, 0.26500580949783326, 0.2544101536273956, 0.25052713922262193, 0.24347249984741212, 0.2570980538129807, 0.25747675395011904, 0.24483826489448549, 0.2679428778171539, 0.2552482491016388, 0.2636564303874969, 0.251675776386261, 0.25061136693954467, 0.25619053938388825, 0.2604283591747284, 0.24980614986419677, 0.2619251715898514, 0.24344707369804383, 0.2594874095439911, 0.2502103290319443, 0.252884268450737, 0.255521265900135, 0.24722041704654693, 0.24901772198677063, 0.251171248292923, 0.2456400051355362, 0.2529362505346537, 0.273858856010437, 0.25111707144379614, 0.26183034324646, 0.24973418912887574, 0.2557036585330963, 0.25409352279901504, 0.2667068808078766, 0.2622226516008377, 0.2573869395017624, 0.2599535757780075, 0.2616206120967865, 0.26548976418972015, 0.269380471137166, 0.25858246313929556, 0.25620280485153196, 0.25432619366645814, 0.2580019128084183, 0.2579445940256119, 0.27430401819944383, 0.2621616680622101, 0.2685223508000374, 0.25827786388397217, 0.2500553507328033, 0.25870244889259336, 0.2535401804924011, 0.2743895295381546, 0.2652854693889618, 0.2664547966718674, 0.2629677951812744, 0.26765587918758393, 0.2737979919672012, 0.27067077598571776, 0.2647852805376053, 0.27476696441173554, 0.2838538411855698, 0.2708610894024372, 0.2747816049814224, 0.29207695996761324, 0.2846724898815155, 0.2878281712770462, 0.26768015435934067, 0.2666513205528259, 0.2681239436388016]

# # seed 2
# ema_ESGD15_s2 = [2.0579672859191893, 2.0579672859191893, 1.953419217634201, 1.8408967722463607, 1.7320140961928367, 1.6309726439824583, 1.5367353848866419, 1.449984209669691, 1.3727095511195617, 1.3007148144791327, 1.2342867606797638, 1.172536178922548, 1.116847792849446, 1.0646304082216365, 1.0191086109430978, 0.9764627905420711, 0.9357790583323464, 0.9009457297543608, 0.8668046537500551, 0.8347389486642418, 0.806381588955975, 0.7786675562944321, 0.7555208585101045, 0.732648239116461, 0.7109476373498955, 0.6908137700067746, 0.6714393284213651, 0.6537451239155628, 0.6372414886468857, 0.6222047814840861, 0.6086021538109888, 0.5954490465412715, 0.5828204789385361, 0.5714379086886492, 0.56045695492935, 0.5504435358331664, 0.5409512728756127, 0.5327643620644918, 0.52508102890446, 0.5192809664803225, 0.5118963685915601, 0.5053363692169546, 0.4986319982998215, 0.4925748267167189, 0.4864377234143059, 0.48109173276204237, 0.47618553380768036, 0.47103618804753306, 0.46672048922187526, 0.46247154481476344, 0.458175254390828, 0.4560911557801296, 0.4519543366451022, 0.44801014186074944, 0.4443482798105235, 0.44129985866121246, 0.43880525718306124, 0.4356883594945784, 0.4324185325153812, 0.43144898453070024, 0.42858340038579673, 0.4262841225277362, 0.42340009519317545, 0.42075823917441485, 0.4185923069744073, 0.41717617457408573, 0.4150453815671701, 0.41278456248994755, 0.4106339664437421, 0.40904054915231897, 0.4073753701793173, 0.40606313412192635, 0.40454792551281904, 0.4023995264466064, 0.4007225542153827, 0.3988446067123931, 0.3971045894458283, 0.3955697438091984, 0.3944250136957423, 0.3935974332808724, 0.39322892753117716, 0.39144590279907077, 0.389987801171393, 0.3880947954568721, 0.38682541203201926, 0.3854711013624172, 0.3843952221717626, 0.38280183943326984, 0.38185534615232686, 0.38050904987556466, 0.3790562164345628, 0.3778457973324578, 0.3784522682169069, 0.3775672149925521, 0.3761982468464158, 0.37500530030413104, 0.37417785310223967, 0.3740154206658179, 0.3726456724796987, 0.37143406070658236, 0.3700055557065189, 0.3686032853531521, 0.36704463789293307, 0.3666576006707174, 0.36601558439522586, 0.3650473800282741, 0.36367137697885016, 0.3629172307546399, 0.36218119324703174, 0.360899134350948, 0.35982239359480067, 0.3602367620324664, 0.3590729252113914, 0.35802590839749715, 0.357149704257424, 0.3572416770694631, 0.3569167500041107, 0.35583406199653567, 0.35515839534556526, 0.3544701437135547, 0.35344121425449937, 0.35332085187941875, 0.3520849401114293, 0.3515701056085147, 0.35124953411836485, 0.35032887101071236, 0.3495675575366362, 0.34874786463773944, 0.34799549769338994, 0.34733034066000906, 0.34649657766734954, 0.3456181119935101, 0.3451643509116518, 0.34436626815737015, 0.34351730799621993, 0.3430396806569098, 0.3422884919987201, 0.3422127952455949, 0.3410355579840664, 0.34036805130370174, 0.3403321081995462]
# x_ESGD15_s2 = [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000, 53500, 54000, 54500, 55000, 55500, 56000, 56500, 57000, 57500, 58000, 58500, 59000, 59500, 60000, 60500, 61000, 61500, 62000, 62500, 63000, 63500, 64000, 64500, 65000, 65500, 66000, 66500, 67000, 67500, 68000, 68500, 69000, 69500, 70000]
# history_ESGD15_s2 = [2.0579672859191893, 1.0124866030693054, 0.8281947637557984, 0.7520700117111206, 0.7215995740890503, 0.688600053024292, 0.6692236327171326, 0.677237624168396, 0.652762184715271, 0.6364342764854432, 0.616780943107605, 0.6156523181915283, 0.5946739465713501, 0.6094124354362488, 0.5926504069328308, 0.5696254684448242, 0.5874457725524902, 0.5595349697113037, 0.546147602891922, 0.5511653515815735, 0.5292412623405457, 0.5472005784511567, 0.5267946645736694, 0.5156422214508056, 0.5096089639186859, 0.49706935415267944, 0.4944972833633423, 0.4887087712287903, 0.4868744170188904, 0.4861785047531128, 0.4770710811138153, 0.469163370513916, 0.46899477643966675, 0.46162837109565735, 0.46032276396751404, 0.4555209062576294, 0.4590821647644043, 0.4559310304641724, 0.4670804046630859, 0.4454349875926971, 0.4462963748455048, 0.4382926600456238, 0.4380602824687958, 0.4312037936925888, 0.43297781689167025, 0.4320297432184219, 0.4246920762062073, 0.42787919979095457, 0.4242310451507568, 0.41950864057540893, 0.437334268283844, 0.41472296442985535, 0.4125123888015747, 0.41139152135849, 0.41386406831741335, 0.4163538438796997, 0.407636280298233, 0.4029900897026062, 0.42272305266857146, 0.40279314308166503, 0.40559062180519106, 0.3974438491821289, 0.39698153500556943, 0.3990989171743393, 0.4044309829711914, 0.3958682445049286, 0.39243719079494477, 0.39127860202789305, 0.3946997935295105, 0.3923887594223022, 0.3942530096054077, 0.39091104803085325, 0.38306393485069273, 0.38562980413436887, 0.38194307918548587, 0.3814444340467453, 0.3817561330795288, 0.38412244267463685, 0.38614920954704285, 0.3899123757839203, 0.3753986802101135, 0.3768648865222931, 0.3710577440261841, 0.3754009612083435, 0.37328230533599854, 0.3747123094558716, 0.3684613947868347, 0.37333690662384034, 0.3683923833847046, 0.36598071546554567, 0.3669520254135132, 0.38391050617694855, 0.36960173597335816, 0.36387753353118896, 0.3642687814235687, 0.3667308282852173, 0.37255352873802183, 0.3603179388046265, 0.36052955474853515, 0.3571490107059479, 0.3559828521728516, 0.3530168107509613, 0.3631742656707764, 0.360237437915802, 0.356333540725708, 0.35128734953403473, 0.35612991473674777, 0.3555568556785583, 0.34936060428619387, 0.35013172678947446, 0.3639660779714584, 0.3485983938217163, 0.34860275707244875, 0.34926386699676515, 0.35806943237781524, 0.3539924064159393, 0.34608986992836, 0.34907739548683164, 0.3482758790254593, 0.3441808491230011, 0.35223759050369263, 0.3409617341995239, 0.34693659508228303, 0.34836439070701597, 0.3420429030418396, 0.3427157362699509, 0.3413706285476685, 0.3412241951942444, 0.34134392735958097, 0.3389927107334137, 0.3377119209289551, 0.3410805011749268, 0.33718352336883545, 0.3358766665458679, 0.3387410346031189, 0.3355277940750122, 0.34153152446746826, 0.33044042263031004, 0.33436049118041994, 0.340008620262146]

# # seed 3
# ema_ESGD15_s3 = [2.196451696395874, 2.196451696395874, 2.1054446193695067, 1.9792569450378417, 1.8616224193763733, 1.7495162704448701, 1.6448584265310289, 1.5495869038461496, 1.460794227884905, 1.3795899284827977, 1.3063074041975977, 1.2387063229918578, 1.1750185405004112, 1.117377470122703, 1.0670316298296405, 1.0182898489019592, 0.9739020983428943, 0.9327377800128926, 0.8946820633252326, 0.8586988748073455, 0.8259447159051785, 0.7961561879944703, 0.7685103845541389, 0.7426388381241004, 0.7196759674571371, 0.6979811084719673, 0.6791775576566614, 0.6602195645071528, 0.6421894296125288, 0.6254940528591617, 0.6110639186322818, 0.5971767882245895, 0.5844234249691472, 0.5725763955253637, 0.561079320939029, 0.5499731006333036, 0.5396113967206004, 0.5304695035981467, 0.5216473745960591, 0.5144380807619033, 0.5072633646447127, 0.5005811528788803, 0.49431226623059493, 0.48811750015021427, 0.4821601743257141, 0.47664422205770873, 0.47075041179613647, 0.4656644411083136, 0.46105670369351576, 0.45663510641471744, 0.45235725657894793, 0.44831384134490415, 0.4466929982393902, 0.4426469895121385, 0.4387524246761438, 0.43521449317597477, 0.43224943697628193, 0.4309123136369301, 0.4291090125424784, 0.42599294493881956, 0.42259776455779163, 0.4196400066013869, 0.41688710926375416, 0.41506737371922997, 0.4132993901858461, 0.41127858168331377, 0.4087011031012022, 0.40691754831495436, 0.40536334324856893, 0.403743055705252, 0.4018726378739083, 0.39981071018042, 0.39779159632618877, 0.39698292368020704, 0.3950885062959739, 0.3937972445774331, 0.39191940631225, 0.38998177260775224, 0.38804250585990124, 0.3865058845253912, 0.38514747371662805, 0.3839185869847758, 0.38267792801335665, 0.38151984232433334, 0.3801541720023843, 0.37876427972356314, 0.3776692311600432, 0.37643739304979906, 0.37515708461678265, 0.3743304316312931, 0.3754028824571546, 0.37442259781155973, 0.37300489941651216, 0.37152130845738585, 0.3699186409791094, 0.3686950243139072, 0.3673983877453629, 0.3668096988827071, 0.3659169902125074, 0.3650988272439605, 0.36384103655676536, 0.3631497778140947, 0.36243545946032807, 0.3616888064433724, 0.3607901319023601, 0.3599000547143786, 0.35852552752014716, 0.3574946772675221, 0.35661627276127084, 0.35627705491946227, 0.35514666285544116, 0.35428865820434224, 0.354103473702668, 0.353161734182476, 0.3525113741983524, 0.3518456878330902, 0.3512756781232294, 0.3504532334684077, 0.3505872473727533, 0.349450686203021, 0.3485027753662272, 0.34746663914125, 0.3465317532289103, 0.3460703981126614, 0.34506908502029787, 0.3443034474275775, 0.34362144308408504, 0.34325152385759716, 0.3429914728283438, 0.34278518679734044, 0.34221796510513997, 0.34160132577445845, 0.3409404035642154, 0.34090243265817227, 0.3405277962630063, 0.3396149588225844, 0.33871851919280554, 0.33832618916797996, 0.3378501129147562, 0.3372715411946612, 0.33669723507095317]
# x_ESGD15_s3 = [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000, 53500, 54000, 54500, 55000, 55500, 56000, 56500, 57000, 57500, 58000, 58500, 59000, 59500, 60000, 60500, 61000, 61500, 62000, 62500, 63000, 63500, 64000, 64500, 65000, 65500, 66000, 66500, 67000, 67500, 68000, 68500, 69000, 69500, 70000]
# history_ESGD15_s3 = [2.196451696395874, 1.2863809261322021, 0.8435678760528564, 0.8029116884231567, 0.7405609300613404, 0.7029378313064575, 0.6921431996822357, 0.6616601442337036, 0.6487512338638306, 0.6467646856307984, 0.6302965921401977, 0.6018284980773926, 0.5986078367233276, 0.6139190671920777, 0.579613820552826, 0.5744123433113099, 0.5622589150428772, 0.5521806131362915, 0.5348501781463623, 0.531157285785675, 0.5280594367980957, 0.519698153591156, 0.5097949202537536, 0.5130101314544677, 0.5027273776054383, 0.5099456003189087, 0.4895976261615753, 0.4799182155609131, 0.4752356620788574, 0.48119271059036256, 0.4721926145553589, 0.469643155670166, 0.46595313053131104, 0.45760564966201783, 0.4500171178817749, 0.4463560615062714, 0.44819246549606323, 0.4422482135772705, 0.44955443625450137, 0.44269091958999635, 0.44044124698638915, 0.4378922863960266, 0.43236460542678834, 0.4285442419052124, 0.4270006516456604, 0.4177061194419861, 0.4198907049179077, 0.41958706696033476, 0.41684073090553286, 0.41385660805702207, 0.41192310423851014, 0.4321054102897644, 0.4062329109668732, 0.40370134115219114, 0.4033731096744537, 0.40556393117904666, 0.4188782035827637, 0.41287930269241335, 0.3979483365058899, 0.39204114112854005, 0.3930201849937439, 0.3921110332250595, 0.39868975381851196, 0.39738753838539126, 0.3930913051605225, 0.38550379586219785, 0.39086555523872374, 0.39137549765110013, 0.38916046781539915, 0.3850388773918152, 0.3812533609390259, 0.3796195716381073, 0.38970486986637115, 0.3780387498378754, 0.38217588911056516, 0.37501886192560197, 0.37254306926727293, 0.3705891051292419, 0.372676292514801, 0.3729217764377594, 0.37285860639810564, 0.3715119972705841, 0.3710970711231232, 0.36786313910484314, 0.36625524921417235, 0.3678137940883636, 0.36535085005760193, 0.36363430871963504, 0.3668905547618866, 0.38505493988990785, 0.36560003600120544, 0.360245613861084, 0.3581689898252487, 0.3554946336746216, 0.3576824743270874, 0.35572865862846376, 0.3615114991188049, 0.3578826121807098, 0.3577353605270386, 0.35252092037200927, 0.3569284491300583, 0.3560065942764282, 0.3549689292907715, 0.3527020610332489, 0.35188936002254484, 0.3461547827720642, 0.3482170249938965, 0.3487106322050095, 0.3532240943431854, 0.3449731342792511, 0.3465666163444519, 0.3524368131875992, 0.3446860785007477, 0.34665813434123993, 0.3458545105457306, 0.3461455907344818, 0.3430512315750122, 0.3517933725118637, 0.3392216356754303, 0.339971577835083, 0.33814141311645507, 0.3381177800178528, 0.3419182020664215, 0.3360572671890259, 0.3374127090930939, 0.3374834039926529, 0.33992225081920624, 0.3406510135650635, 0.3409286125183105, 0.3371129698753357, 0.33605157179832457, 0.3349921036720276, 0.3405606945037842, 0.33715606870651244, 0.3313994218587875, 0.3306505625247955, 0.33479521894454956, 0.3335654266357422, 0.33206439571380614, 0.33152847995758056]

# ## for std graphs
# # same x for all trials
# x_ESGD15_avg = [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000, 53500, 54000, 54500, 55000, 55500, 56000, 56500, 57000, 57500, 58000, 58500, 59000, 59500, 60000, 60500, 61000, 61500, 62000, 62500, 63000, 63500, 64000, 64500, 65000, 65500, 66000, 66500, 67000, 67500, 68000, 68500, 69000, 69500, 70000]


x_ESGD15_avg = [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000]


## ESGD
# seed 1
ema_ESGD15_s1 = [0.7147568140029907, 0.7147568140029907, 0.7063239600372315, 0.6904548344116211, 0.6737380081016541, 0.6529779560326385, 0.6312089610408707, 0.6110588607684639, 0.5913711296059967, 0.572636624606098, 0.5552297108408617, 0.5392673656436927, 0.5238285007548148, 0.5087118442230059, 0.4956699083101123, 0.48244700060707657, 0.46923594914217887, 0.45864946948713153, 0.44770697970890483, 0.4363916123006059, 0.4253704713428003, 0.4155497089222654, 0.4061756981702671, 0.3984000114117884, 0.38980988669826, 0.3817943898096688, 0.3738245924259729, 0.36680000767697457, 0.36022366800894945, 0.35444774962476444, 0.3475625654454072, 0.3411030203457212, 0.3351495013614478, 0.3299197999149545, 0.3247554833701239, 0.32005707379558557, 0.31582810273270795, 0.3117660646018474, 0.30849209666404925, 0.30568624790806, 0.3026341200616815, 0.29921485983135027, 0.2960857052815114, 0.2940475748803158, 0.29156016368859466, 0.28966137870544306, 0.2875035294758747, 0.28509831545479325, 0.28341998261088636, 0.2811936787081466, 0.2796161113505995, 0.27853373191643677, 0.2782309327044093, 0.276636747925103, 0.2746382516222778, 0.27277284675576535, 0.27078584412221535, 0.269158627746264, 0.2677651829413413, 0.26762456534729945, 0.26611578773999106, 0.2649905692608108, 0.26415705728807604, 0.26383652404080526, 0.26298465265688925, 0.26200204312316444, 0.261466875126766, 0.26094804889453066, 0.2600120017346079, 0.2588758463462891, 0.25870860681599694, 0.2582846699434488, 0.2589567838988872, 0.2585021208717381, 0.2577046227068265, 0.25628141042088504, 0.2563630747600946, 0.2564744426790971, 0.25531082490063595, 0.25657403019228775, 0.25644145208322283, 0.25716294991365024, 0.2566142325609113, 0.25601394599877464, 0.25603160533728603, 0.25647128072103026, 0.25580476763534693, 0.25641680803079736, 0.255119834597522, 0.2555565920921689, 0.25502196578614644, 0.2548081960526055, 0.25487950303735846, 0.2541135944382773, 0.25360400719312665, 0.25336073130310627, 0.2525886586863493, 0.2526234178711797, 0.2547469616851054, 0.2543839726609745, 0.25512860971952306, 0.25458916766045836, 0.25470061674772215, 0.25463990735285147, 0.255846604698354, 0.2564842093886024, 0.25657448239991837, 0.2569123917377273, 0.2573832137736332, 0.2581938688152419, 0.25931252904743435, 0.25923952245662046, 0.25893585069611164, 0.2584748849931463, 0.2584275877746735, 0.25837928839976737, 0.259971761379735, 0.2601907520479825, 0.26102391192318797, 0.26074930711926636, 0.2596799114806201, 0.25958216522181743, 0.2589779667488758, 0.26051912302780367, 0.26099575766391947, 0.26154166156471426, 0.26168427492637025, 0.26228143535249165, 0.2634330910139626, 0.26415685951113815, 0.2642197016137849, 0.26527442789357997, 0.26713236922277894, 0.26750524124074476, 0.2682328776148125, 0.2706172858500926, 0.2720228062532349, 0.27360334275561604, 0.2730110239159885, 0.2723750535796723, 0.2719499425855852]
ema_ESGD15_s1 = ema_ESGD15_s1[:len(x_ESGD15_avg)]

x_ESGD15_s1 = x_ESGD15_avg

history_ESGD15_s1 = [0.7147568140029907, 0.6304282743453979, 0.5476327037811279, 0.5232865713119507, 0.466137487411499, 0.4352880061149597, 0.429707958316803, 0.4141815491437912, 0.40402607960700987, 0.39856748695373534, 0.39560625886917117, 0.3848787167549133, 0.3726619354367256, 0.37829248509407043, 0.36344083127975463, 0.35033648595809935, 0.3633711525917053, 0.3492245717048645, 0.3345533056259155, 0.32618020272254944, 0.3271628471374512, 0.3218096014022827, 0.3284188305854797, 0.3124987642765045, 0.3096549178123474, 0.30209641597270964, 0.30357874493598935, 0.3010366109967232, 0.302464484167099, 0.28559590783119204, 0.2829671144485474, 0.2815678305029869, 0.2828524868965149, 0.2782766344666481, 0.2777713876247406, 0.27776736316680906, 0.27520772142410277, 0.2790263852238655, 0.2804336091041565, 0.2751649694442749, 0.26844151775836944, 0.267923314332962, 0.2757044012695551, 0.26917346296310424, 0.27257231385707853, 0.2680828864097595, 0.2634513892650604, 0.2683149870157242, 0.26115694358348845, 0.26541800513267516, 0.26879231700897216, 0.27550573979616166, 0.26228908491134645, 0.2566517848968506, 0.2559842029571533, 0.2529028204202652, 0.2545136803627014, 0.25522417969703676, 0.26635900700092313, 0.2525367892742157, 0.25486360294818877, 0.25665544953346253, 0.26095172481536866, 0.2553178102016449, 0.2531585573196411, 0.25665036315917966, 0.25627861280441283, 0.25158757729530334, 0.24865044785141946, 0.2572034510433674, 0.25446923809051514, 0.26500580949783326, 0.2544101536273956, 0.25052713922262193, 0.24347249984741212, 0.2570980538129807, 0.25747675395011904, 0.24483826489448549, 0.2679428778171539, 0.2552482491016388, 0.2636564303874969, 0.251675776386261, 0.25061136693954467, 0.25619053938388825, 0.2604283591747284, 0.24980614986419677, 0.2619251715898514, 0.24344707369804383, 0.2594874095439911, 0.2502103290319443, 0.252884268450737, 0.255521265900135, 0.24722041704654693, 0.24901772198677063, 0.251171248292923, 0.2456400051355362, 0.2529362505346537, 0.273858856010437, 0.25111707144379614, 0.26183034324646, 0.24973418912887574, 0.2557036585330963, 0.25409352279901504, 0.2667068808078766, 0.2622226516008377, 0.2573869395017624, 0.2599535757780075, 0.2616206120967865, 0.26548976418972015, 0.269380471137166, 0.25858246313929556, 0.25620280485153196, 0.25432619366645814, 0.2580019128084183, 0.2579445940256119, 0.27430401819944383, 0.2621616680622101, 0.2685223508000374, 0.25827786388397217, 0.2500553507328033, 0.25870244889259336, 0.2535401804924011, 0.2743895295381546, 0.2652854693889618, 0.2664547966718674, 0.2629677951812744, 0.26765587918758393, 0.2737979919672012, 0.27067077598571776, 0.2647852805376053, 0.27476696441173554, 0.2838538411855698, 0.2708610894024372, 0.2747816049814224, 0.29207695996761324, 0.2846724898815155, 0.2878281712770462, 0.26768015435934067, 0.2666513205528259, 0.2681239436388016]
history_ESGD15_s1 = history_ESGD15_s1[:len(x_ESGD15_avg)]

# seed 2
ema_ESGD15_s2 = [2.0579672859191893, 2.0579672859191893, 1.953419217634201, 1.8408967722463607, 1.7320140961928367, 1.6309726439824583, 1.5367353848866419, 1.449984209669691, 1.3727095511195617, 1.3007148144791327, 1.2342867606797638, 1.172536178922548, 1.116847792849446, 1.0646304082216365, 1.0191086109430978, 0.9764627905420711, 0.9357790583323464, 0.9009457297543608, 0.8668046537500551, 0.8347389486642418, 0.806381588955975, 0.7786675562944321, 0.7555208585101045, 0.732648239116461, 0.7109476373498955, 0.6908137700067746, 0.6714393284213651, 0.6537451239155628, 0.6372414886468857, 0.6222047814840861, 0.6086021538109888, 0.5954490465412715, 0.5828204789385361, 0.5714379086886492, 0.56045695492935, 0.5504435358331664, 0.5409512728756127, 0.5327643620644918, 0.52508102890446, 0.5192809664803225, 0.5118963685915601, 0.5053363692169546, 0.4986319982998215, 0.4925748267167189, 0.4864377234143059, 0.48109173276204237, 0.47618553380768036, 0.47103618804753306, 0.46672048922187526, 0.46247154481476344, 0.458175254390828, 0.4560911557801296, 0.4519543366451022, 0.44801014186074944, 0.4443482798105235, 0.44129985866121246, 0.43880525718306124, 0.4356883594945784, 0.4324185325153812, 0.43144898453070024, 0.42858340038579673, 0.4262841225277362, 0.42340009519317545, 0.42075823917441485, 0.4185923069744073, 0.41717617457408573, 0.4150453815671701, 0.41278456248994755, 0.4106339664437421, 0.40904054915231897, 0.4073753701793173, 0.40606313412192635, 0.40454792551281904, 0.4023995264466064, 0.4007225542153827, 0.3988446067123931, 0.3971045894458283, 0.3955697438091984, 0.3944250136957423, 0.3935974332808724, 0.39322892753117716, 0.39144590279907077, 0.389987801171393, 0.3880947954568721, 0.38682541203201926, 0.3854711013624172, 0.3843952221717626, 0.38280183943326984, 0.38185534615232686, 0.38050904987556466, 0.3790562164345628, 0.3778457973324578, 0.3784522682169069, 0.3775672149925521, 0.3761982468464158, 0.37500530030413104, 0.37417785310223967, 0.3740154206658179, 0.3726456724796987, 0.37143406070658236, 0.3700055557065189, 0.3686032853531521, 0.36704463789293307, 0.3666576006707174, 0.36601558439522586, 0.3650473800282741, 0.36367137697885016, 0.3629172307546399, 0.36218119324703174, 0.360899134350948, 0.35982239359480067, 0.3602367620324664, 0.3590729252113914, 0.35802590839749715, 0.357149704257424, 0.3572416770694631, 0.3569167500041107, 0.35583406199653567, 0.35515839534556526, 0.3544701437135547, 0.35344121425449937, 0.35332085187941875, 0.3520849401114293, 0.3515701056085147, 0.35124953411836485, 0.35032887101071236, 0.3495675575366362, 0.34874786463773944, 0.34799549769338994, 0.34733034066000906, 0.34649657766734954, 0.3456181119935101, 0.3451643509116518, 0.34436626815737015, 0.34351730799621993, 0.3430396806569098, 0.3422884919987201, 0.3422127952455949, 0.3410355579840664, 0.34036805130370174, 0.3403321081995462]
ema_ESGD15_s2 = ema_ESGD15_s2[:len(x_ESGD15_avg)]

x_ESGD15_s2 = [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000, 53500, 54000, 54500, 55000, 55500, 56000, 56500, 57000, 57500, 58000, 58500, 59000, 59500, 60000, 60500, 61000, 61500, 62000, 62500, 63000, 63500, 64000, 64500, 65000, 65500, 66000, 66500, 67000, 67500, 68000, 68500, 69000, 69500, 70000]
x_ESGD15_s2 = x_ESGD15_avg

history_ESGD15_s2 = [2.0579672859191893, 1.0124866030693054, 0.8281947637557984, 0.7520700117111206, 0.7215995740890503, 0.688600053024292, 0.6692236327171326, 0.677237624168396, 0.652762184715271, 0.6364342764854432, 0.616780943107605, 0.6156523181915283, 0.5946739465713501, 0.6094124354362488, 0.5926504069328308, 0.5696254684448242, 0.5874457725524902, 0.5595349697113037, 0.546147602891922, 0.5511653515815735, 0.5292412623405457, 0.5472005784511567, 0.5267946645736694, 0.5156422214508056, 0.5096089639186859, 0.49706935415267944, 0.4944972833633423, 0.4887087712287903, 0.4868744170188904, 0.4861785047531128, 0.4770710811138153, 0.469163370513916, 0.46899477643966675, 0.46162837109565735, 0.46032276396751404, 0.4555209062576294, 0.4590821647644043, 0.4559310304641724, 0.4670804046630859, 0.4454349875926971, 0.4462963748455048, 0.4382926600456238, 0.4380602824687958, 0.4312037936925888, 0.43297781689167025, 0.4320297432184219, 0.4246920762062073, 0.42787919979095457, 0.4242310451507568, 0.41950864057540893, 0.437334268283844, 0.41472296442985535, 0.4125123888015747, 0.41139152135849, 0.41386406831741335, 0.4163538438796997, 0.407636280298233, 0.4029900897026062, 0.42272305266857146, 0.40279314308166503, 0.40559062180519106, 0.3974438491821289, 0.39698153500556943, 0.3990989171743393, 0.4044309829711914, 0.3958682445049286, 0.39243719079494477, 0.39127860202789305, 0.3946997935295105, 0.3923887594223022, 0.3942530096054077, 0.39091104803085325, 0.38306393485069273, 0.38562980413436887, 0.38194307918548587, 0.3814444340467453, 0.3817561330795288, 0.38412244267463685, 0.38614920954704285, 0.3899123757839203, 0.3753986802101135, 0.3768648865222931, 0.3710577440261841, 0.3754009612083435, 0.37328230533599854, 0.3747123094558716, 0.3684613947868347, 0.37333690662384034, 0.3683923833847046, 0.36598071546554567, 0.3669520254135132, 0.38391050617694855, 0.36960173597335816, 0.36387753353118896, 0.3642687814235687, 0.3667308282852173, 0.37255352873802183, 0.3603179388046265, 0.36052955474853515, 0.3571490107059479, 0.3559828521728516, 0.3530168107509613, 0.3631742656707764, 0.360237437915802, 0.356333540725708, 0.35128734953403473, 0.35612991473674777, 0.3555568556785583, 0.34936060428619387, 0.35013172678947446, 0.3639660779714584, 0.3485983938217163, 0.34860275707244875, 0.34926386699676515, 0.35806943237781524, 0.3539924064159393, 0.34608986992836, 0.34907739548683164, 0.3482758790254593, 0.3441808491230011, 0.35223759050369263, 0.3409617341995239, 0.34693659508228303, 0.34836439070701597, 0.3420429030418396, 0.3427157362699509, 0.3413706285476685, 0.3412241951942444, 0.34134392735958097, 0.3389927107334137, 0.3377119209289551, 0.3410805011749268, 0.33718352336883545, 0.3358766665458679, 0.3387410346031189, 0.3355277940750122, 0.34153152446746826, 0.33044042263031004, 0.33436049118041994, 0.340008620262146]
history_ESGD15_s2 = history_ESGD15_s2[:len(x_ESGD15_avg)]


# seed 3
ema_ESGD15_s3 = [2.196451696395874, 2.196451696395874, 2.1054446193695067, 1.9792569450378417, 1.8616224193763733, 1.7495162704448701, 1.6448584265310289, 1.5495869038461496, 1.460794227884905, 1.3795899284827977, 1.3063074041975977, 1.2387063229918578, 1.1750185405004112, 1.117377470122703, 1.0670316298296405, 1.0182898489019592, 0.9739020983428943, 0.9327377800128926, 0.8946820633252326, 0.8586988748073455, 0.8259447159051785, 0.7961561879944703, 0.7685103845541389, 0.7426388381241004, 0.7196759674571371, 0.6979811084719673, 0.6791775576566614, 0.6602195645071528, 0.6421894296125288, 0.6254940528591617, 0.6110639186322818, 0.5971767882245895, 0.5844234249691472, 0.5725763955253637, 0.561079320939029, 0.5499731006333036, 0.5396113967206004, 0.5304695035981467, 0.5216473745960591, 0.5144380807619033, 0.5072633646447127, 0.5005811528788803, 0.49431226623059493, 0.48811750015021427, 0.4821601743257141, 0.47664422205770873, 0.47075041179613647, 0.4656644411083136, 0.46105670369351576, 0.45663510641471744, 0.45235725657894793, 0.44831384134490415, 0.4466929982393902, 0.4426469895121385, 0.4387524246761438, 0.43521449317597477, 0.43224943697628193, 0.4309123136369301, 0.4291090125424784, 0.42599294493881956, 0.42259776455779163, 0.4196400066013869, 0.41688710926375416, 0.41506737371922997, 0.4132993901858461, 0.41127858168331377, 0.4087011031012022, 0.40691754831495436, 0.40536334324856893, 0.403743055705252, 0.4018726378739083, 0.39981071018042, 0.39779159632618877, 0.39698292368020704, 0.3950885062959739, 0.3937972445774331, 0.39191940631225, 0.38998177260775224, 0.38804250585990124, 0.3865058845253912, 0.38514747371662805, 0.3839185869847758, 0.38267792801335665, 0.38151984232433334, 0.3801541720023843, 0.37876427972356314, 0.3776692311600432, 0.37643739304979906, 0.37515708461678265, 0.3743304316312931, 0.3754028824571546, 0.37442259781155973, 0.37300489941651216, 0.37152130845738585, 0.3699186409791094, 0.3686950243139072, 0.3673983877453629, 0.3668096988827071, 0.3659169902125074, 0.3650988272439605, 0.36384103655676536, 0.3631497778140947, 0.36243545946032807, 0.3616888064433724, 0.3607901319023601, 0.3599000547143786, 0.35852552752014716, 0.3574946772675221, 0.35661627276127084, 0.35627705491946227, 0.35514666285544116, 0.35428865820434224, 0.354103473702668, 0.353161734182476, 0.3525113741983524, 0.3518456878330902, 0.3512756781232294, 0.3504532334684077, 0.3505872473727533, 0.349450686203021, 0.3485027753662272, 0.34746663914125, 0.3465317532289103, 0.3460703981126614, 0.34506908502029787, 0.3443034474275775, 0.34362144308408504, 0.34325152385759716, 0.3429914728283438, 0.34278518679734044, 0.34221796510513997, 0.34160132577445845, 0.3409404035642154, 0.34090243265817227, 0.3405277962630063, 0.3396149588225844, 0.33871851919280554, 0.33832618916797996, 0.3378501129147562, 0.3372715411946612, 0.33669723507095317]
ema_ESGD15_s3 = ema_ESGD15_s3[:len(x_ESGD15_avg)]

x_ESGD15_s3 = [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000, 53500, 54000, 54500, 55000, 55500, 56000, 56500, 57000, 57500, 58000, 58500, 59000, 59500, 60000, 60500, 61000, 61500, 62000, 62500, 63000, 63500, 64000, 64500, 65000, 65500, 66000, 66500, 67000, 67500, 68000, 68500, 69000, 69500, 70000]
x_ESGD15_s3 = x_ESGD15_avg

history_ESGD15_s3 = [2.196451696395874, 1.2863809261322021, 0.8435678760528564, 0.8029116884231567, 0.7405609300613404, 0.7029378313064575, 0.6921431996822357, 0.6616601442337036, 0.6487512338638306, 0.6467646856307984, 0.6302965921401977, 0.6018284980773926, 0.5986078367233276, 0.6139190671920777, 0.579613820552826, 0.5744123433113099, 0.5622589150428772, 0.5521806131362915, 0.5348501781463623, 0.531157285785675, 0.5280594367980957, 0.519698153591156, 0.5097949202537536, 0.5130101314544677, 0.5027273776054383, 0.5099456003189087, 0.4895976261615753, 0.4799182155609131, 0.4752356620788574, 0.48119271059036256, 0.4721926145553589, 0.469643155670166, 0.46595313053131104, 0.45760564966201783, 0.4500171178817749, 0.4463560615062714, 0.44819246549606323, 0.4422482135772705, 0.44955443625450137, 0.44269091958999635, 0.44044124698638915, 0.4378922863960266, 0.43236460542678834, 0.4285442419052124, 0.4270006516456604, 0.4177061194419861, 0.4198907049179077, 0.41958706696033476, 0.41684073090553286, 0.41385660805702207, 0.41192310423851014, 0.4321054102897644, 0.4062329109668732, 0.40370134115219114, 0.4033731096744537, 0.40556393117904666, 0.4188782035827637, 0.41287930269241335, 0.3979483365058899, 0.39204114112854005, 0.3930201849937439, 0.3921110332250595, 0.39868975381851196, 0.39738753838539126, 0.3930913051605225, 0.38550379586219785, 0.39086555523872374, 0.39137549765110013, 0.38916046781539915, 0.3850388773918152, 0.3812533609390259, 0.3796195716381073, 0.38970486986637115, 0.3780387498378754, 0.38217588911056516, 0.37501886192560197, 0.37254306926727293, 0.3705891051292419, 0.372676292514801, 0.3729217764377594, 0.37285860639810564, 0.3715119972705841, 0.3710970711231232, 0.36786313910484314, 0.36625524921417235, 0.3678137940883636, 0.36535085005760193, 0.36363430871963504, 0.3668905547618866, 0.38505493988990785, 0.36560003600120544, 0.360245613861084, 0.3581689898252487, 0.3554946336746216, 0.3576824743270874, 0.35572865862846376, 0.3615114991188049, 0.3578826121807098, 0.3577353605270386, 0.35252092037200927, 0.3569284491300583, 0.3560065942764282, 0.3549689292907715, 0.3527020610332489, 0.35188936002254484, 0.3461547827720642, 0.3482170249938965, 0.3487106322050095, 0.3532240943431854, 0.3449731342792511, 0.3465666163444519, 0.3524368131875992, 0.3446860785007477, 0.34665813434123993, 0.3458545105457306, 0.3461455907344818, 0.3430512315750122, 0.3517933725118637, 0.3392216356754303, 0.339971577835083, 0.33814141311645507, 0.3381177800178528, 0.3419182020664215, 0.3360572671890259, 0.3374127090930939, 0.3374834039926529, 0.33992225081920624, 0.3406510135650635, 0.3409286125183105, 0.3371129698753357, 0.33605157179832457, 0.3349921036720276, 0.3405606945037842, 0.33715606870651244, 0.3313994218587875, 0.3306505625247955, 0.33479521894454956, 0.3335654266357422, 0.33206439571380614, 0.33152847995758056]
history_ESGD15_s3 = history_ESGD15_s3[:len(x_ESGD15_avg)]


# # Seed 4
# ema:
ema_ESGD15_s4 = [2.1554308227539063, 2.1554308227539063, 2.0569267416381836, 1.9339660851249696, 1.8168065864643097, 1.7084597298217392, 1.6130557623785058, 1.5195378790308225, 1.4333619057639708, 1.3546505931935553, 1.283503039434121, 1.2169765236376817, 1.1558028812073853, 1.100247600429939, 1.0497764903751197, 1.002765069012092, 0.9598276105727969, 0.9196011799579458, 0.8841250290756462, 0.8497141809646819, 0.8189385605404855, 0.7892248597779943, 0.7640384225844509, 0.7393288872718066, 0.715891524772577, 0.6938642251462332, 0.674359586546176, 0.6556499418068111, 0.6385645780677958, 0.622894635058227, 0.6093952479607905, 0.5958692901546101, 0.5836042776239818, 0.5714551146435356, 0.5609888418991222, 0.5511224411629607, 0.5412874512847933, 0.5323051291719084, 0.5243286837662762, 0.515974054515854, 0.5082528767101426, 0.5019618355696612, 0.4957636452101363, 0.48996072426879644, 0.4843518615720651, 0.47879375349026754, 0.47431346960909815, 0.46909407460016894, 0.4638739689981004, 0.45992759911969844, 0.455465122415622, 0.4527400410288571, 0.44881365748709434, 0.4451561605232894, 0.4416305577818697, 0.43879044242478715, 0.4355707210902331, 0.43360614594375707, 0.43027036051770107, 0.42800206750410846, 0.4257331457249348, 0.4230280918316863, 0.420200489822342, 0.4180872556632584, 0.41587430930130115, 0.4134737387990275, 0.41128717598575226, 0.4094214044444967, 0.4077081182891019, 0.4058546026504536, 0.4037078098067492, 0.40155336353142707, 0.39961705720567386, 0.3979006250656576, 0.3965821962866424, 0.39580475053607567, 0.39448272659616895, 0.393180025924181, 0.3919616116782442, 0.39048454682771105, 0.389134118809197, 0.38766742896845374, 0.3860529727585057, 0.38464423536005077, 0.38357397529192977, 0.3819997421018023, 0.38058156221077494, 0.3789960312548189, 0.3782770331975438, 0.37683757405846874, 0.3759111570647618, 0.3744074812100465, 0.373142116876197, 0.37230780730344554, 0.3711288955840263, 0.37000550695593293, 0.3694060029369754, 0.36858016990859765, 0.36804134445702547, 0.3670385214947061, 0.3662205705722329, 0.36558772011043045, 0.3647410945961602, 0.3639612262931223, 0.3630704300683816, 0.3621103498663378, 0.3613855278914457, 0.36087760921585127, 0.3598666344070515, 0.359560014567144, 0.3584893688404863, 0.35794717234530793, 0.35707632114433124, 0.35629168871709294, 0.35559654354991244, 0.3549395212454354, 0.35402147878313855, 0.35336263251100297, 0.3530011683207242, 0.352434317227139, 0.35197857503289043, 0.3511291100447839, 0.35012173646916145, 0.3490654073366153, 0.3481084265633191, 0.3472873063448458, 0.34628356823355455, 0.346177774147664, 0.3463420860378216, 0.34579318864181074, 0.3449397414168814, 0.34411641667495063, 0.3431766307575395, 0.3427479392107925, 0.3417723779204429, 0.34182324136283465, 0.34154365075278104, 0.3408078171311124, 0.3405145675520573, 0.3397692459172434, 0.3394254117166781]
ema_ESGD15_s3 = ema_ESGD15_s3[:len(x_ESGD15_avg)]

x_ESGD15_s4 = x_ESGD15_avg
# x:
# [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000, 53500, 54000, 54500, 55000, 55500, 56000, 56500, 57000, 57500, 58000, 58500, 59000, 59500, 60000, 60500, 61000, 61500, 62000, 62500, 63000, 63500, 64000, 64500, 65000, 65500, 66000, 66500, 67000, 67500, 68000, 68500, 69000, 69500, 70000]

# history:
history_ESGD15_s4 = [2.1554308227539063, 1.1703900115966797, 0.8273201765060425, 0.7623710985183716, 0.7333380200386047, 0.7544200553894043, 0.6778769289016724, 0.6577781463623047, 0.6462487800598145, 0.6431750555992126, 0.6182378814697266, 0.6052400993347168, 0.6002500734329224, 0.5955364998817444, 0.5796622767448425, 0.5733904846191407, 0.5575633044242859, 0.5648396711349487, 0.5400165479660034, 0.5419579767227173, 0.5218015529155732, 0.5373604878425599, 0.5169430694580078, 0.5049552622795105, 0.49561852850914, 0.4988178391456604, 0.48726313915252684, 0.4847963044166565, 0.48186514797210694, 0.4879007640838623, 0.4741356698989868, 0.47321916484832766, 0.46211264781951905, 0.46679238719940186, 0.4623248345375061, 0.4527725423812866, 0.45146423015594483, 0.4525406751155853, 0.44078239126205443, 0.4387622764587402, 0.4453424653053284, 0.439979931974411, 0.43773443579673765, 0.43387209730148313, 0.42877078075408936, 0.4339909146785736, 0.4221195195198059, 0.416893018579483, 0.4244102702140808, 0.4153028320789337, 0.42821430854797365, 0.41347620561122894, 0.4122386878490448, 0.40990013310909273, 0.4132294042110443, 0.4065932290792465, 0.41592496962547304, 0.40024829168319703, 0.4075874303817749, 0.4053128497123718, 0.39868260679244993, 0.3947520717382431, 0.3990681482315063, 0.3959577920436859, 0.39186860427856446, 0.39160811066627504, 0.3926294605731964, 0.3922885428905487, 0.3891729619026184, 0.38438667421340944, 0.38216334705352784, 0.3821903002738953, 0.3824527358055115, 0.3847163372755051, 0.38880773878097535, 0.38258451113700864, 0.38145571987628935, 0.3809958834648132, 0.3771909631729126, 0.3769802666425705, 0.3744672204017639, 0.3715228668689728, 0.3719655987739563, 0.3739416346788406, 0.3678316433906555, 0.36781794319152833, 0.3647262526512146, 0.37180605068206785, 0.3638824418067932, 0.36757340412139894, 0.36087439851760866, 0.3617538378715515, 0.3647990211486816, 0.3605186901092529, 0.359895009303093, 0.3640104667663574, 0.36114767265319825, 0.36319191539287565, 0.3580131148338318, 0.35885901226997374, 0.35989206595420836, 0.3571214649677277, 0.35694241156578066, 0.35505326404571536, 0.35346962804794313, 0.3548621301174164, 0.35630634113550186, 0.3507678611278534, 0.3568004360079765, 0.3488535573005676, 0.3530674038887024, 0.3492386603355408, 0.3492299968719482, 0.3493402370452881, 0.3490263205051422, 0.34575909662246707, 0.34743301606178284, 0.3497479906082153, 0.34733265738487246, 0.3478768952846527, 0.34348392515182496, 0.341055374288559, 0.33955844514369965, 0.33949559960365294, 0.3398972243785858, 0.3372499252319336, 0.34522562737464907, 0.34782089304924013, 0.340853112077713, 0.3372587163925171, 0.33670649399757385, 0.33471855750083923, 0.33888971529006956, 0.33299232630729675, 0.34228101234436037, 0.33902733526229856, 0.3341853145360947, 0.3378753213405609, 0.33306135120391844, 0.3363309039115906]
history_ESGD15_s4 = history_ESGD15_s4[:len(x_ESGD15_avg)]


# # seed 5:
# ema:
ema_ESGD15_s5 = [2.203478192901611, 2.203478192901611, 2.120715359382629, 1.9957320325775145, 1.875100693848419, 1.7623198598933407, 1.6567331205051115, 1.5594334031964217, 1.4719300792513674, 1.390814058897947, 1.315323726144482, 1.2478251242819869, 1.1850833558055855, 1.1269533005022792, 1.0732989603278449, 1.023293267872102, 0.9777268418379131, 0.9350321822703633, 0.8974392847639996, 0.8619664703699361, 0.8292013328849445, 0.7989876310568306, 0.7719558284289766, 0.7458027660996135, 0.7240880865803733, 0.701779451677028, 0.6818926980300162, 0.6639059742513371, 0.6472186973723537, 0.630484563764879, 0.6152738126238724, 0.6008784853566176, 0.5880533541251856, 0.5759738954254661, 0.5649051350619203, 0.5539665929865067, 0.5436861543146871, 0.5343488143463226, 0.5252878609150016, 0.5171469911357192, 0.5115058754343177, 0.5049642872862564, 0.4981064438628447, 0.4925492482299172, 0.4876507452638057, 0.4818268150035537, 0.47765237526154486, 0.4719179629307029, 0.46668948165247176, 0.46210645155611035, 0.45827488601895333, 0.4547792458953753, 0.45051293125351916, 0.4466476938456355, 0.44342686909884743, 0.43980917819783566, 0.43621163648526795, 0.4336077771999919, 0.43039554407761843, 0.42828964669614744, 0.42713309313454967, 0.42462034181116887, 0.42173725037955223, 0.4191913973723321, 0.4163827003736319, 0.4142514536707719, 0.41227291326127524, 0.40978416792513794, 0.40753633775319337, 0.4057413209784539, 0.4044757292343835, 0.4024888614148194, 0.40103284005853185, 0.39937311249017104, 0.3978497411415522, 0.3962650317077826, 0.3950501512615374, 0.39356472414807897, 0.39146001296946187, 0.39042706917621595, 0.38878011240450655, 0.3872138458659182, 0.38619543388693905, 0.3847156886816863, 0.38327445101507107, 0.3822695434597218, 0.38085030801538383, 0.3793030521289446, 0.37832572264694614, 0.3770762617923925, 0.3766473220030764, 0.37536512159827046, 0.3740743307976963, 0.3727435695662238, 0.372026872690988, 0.37069926353735244, 0.3696594671122061, 0.36878751335905435, 0.3673629773589949, 0.3664515788197202, 0.3652975807058527, 0.364532379262541, 0.3637009744604477, 0.3624514723169847, 0.36157578384888567, 0.3609558013464129, 0.3603539469741389, 0.3592974572917168, 0.3599803619093011, 0.3590217176842371, 0.35800379269430155, 0.35709020654716295, 0.35592946201167885, 0.3550981892132972, 0.3539878358481122, 0.35302062087158503, 0.3522641539630307, 0.35229205844673633, 0.3523419596768002, 0.35150608780174675, 0.350401744471096, 0.3492887315983501, 0.3485515506119961, 0.3479297042284698, 0.34732836555668334, 0.34680803389813264, 0.3461111157774844, 0.34514105995773536, 0.34427136058580216, 0.34365286824021934, 0.34306040336472576, 0.3421566119448792, 0.3420753083434508, 0.34136522270144276, 0.340515021222543, 0.34044452571545064, 0.3397668733853759, 0.33918182408499675, 0.3385847549911257, 0.33769019944631307, 0.33755474152770565]
ema_ESGD15_s5 = ema_ESGD15_s5[:len(x_ESGD15_avg)]

x_ESGD15_s5 = x_ESGD15_avg
# x:
# [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000, 53500, 54000, 54500, 55000, 55500, 56000, 56500, 57000, 57500, 58000, 58500, 59000, 59500, 60000, 60500, 61000, 61500, 62000, 62500, 63000, 63500, 64000, 64500, 65000, 65500, 66000, 66500, 67000, 67500, 68000, 68500, 69000, 69500, 70000]

# history:
history_ESGD15_s5 = [2.203478192901611, 1.375849857711792, 0.870882091331482, 0.78941864528656, 0.747292354297638, 0.7064524660110474, 0.6837359474182129, 0.6844001637458801, 0.6607698757171631, 0.6359107313632965, 0.6403377075195312, 0.6204074395179748, 0.6037828027725219, 0.5904098987579346, 0.5732420357704162, 0.5676290075302124, 0.5507802461624145, 0.5591032072067261, 0.5427111408233642, 0.5343150955200195, 0.5270643146038055, 0.5286696047782898, 0.5104252051353455, 0.5286559709072113, 0.5010017375469208, 0.5029119152069091, 0.5020254602432251, 0.4970332054615021, 0.47987736129760744, 0.47837705235481265, 0.47132053995132445, 0.47262717304229734, 0.46725876712799075, 0.4652862917900085, 0.45551971430778504, 0.45116220626831055, 0.4503127546310425, 0.4437392800331116, 0.4438791631221771, 0.4607358341217041, 0.44608999395370486, 0.4363858530521393, 0.44253448753356933, 0.4435642185688019, 0.4294114426612854, 0.44008241758346556, 0.420308251953125, 0.4196331501483917, 0.420859180688858, 0.4237907961845398, 0.42331848478317263, 0.41211609947681427, 0.4118605571746826, 0.4144394463777542, 0.4072499600887299, 0.4038337610721588, 0.41017304363250734, 0.40148544597625735, 0.4093365702629089, 0.41672411108016966, 0.4020055799007416, 0.39578942749500273, 0.3962787203073502, 0.3911044273853302, 0.3950702333450317, 0.39446604957580567, 0.38738545989990236, 0.3873058662056923, 0.3895861700057983, 0.39308540353775023, 0.38460705103874204, 0.387928647851944, 0.3844355643749237, 0.38413939900398253, 0.38200264680385587, 0.3841162272453308, 0.3801958801269531, 0.37251761236190795, 0.38113057503700254, 0.3739575014591217, 0.37311744701862337, 0.3770297260761261, 0.37139798183441164, 0.37030331201553346, 0.37322537546157836, 0.3680771890163422, 0.3653777491509914, 0.36952975730896, 0.3658311141014099, 0.37278686389923094, 0.3638253179550171, 0.3624572135925293, 0.3607667184829712, 0.36557660081386567, 0.35875078115463255, 0.36030129928588867, 0.3609399295806885, 0.35454215335845946, 0.35824899196624754, 0.3549115976810455, 0.3576455662727356, 0.3562183312416077, 0.35120595302581786, 0.353694587635994, 0.35537595882415773, 0.3549372576236725, 0.3497890501499176, 0.3661265034675598, 0.3503939196586609, 0.3488424677848816, 0.34886793122291565, 0.3454827611923218, 0.34761673402786253, 0.34399465556144715, 0.34431568608283997, 0.34545595178604127, 0.352543198800087, 0.3527910707473755, 0.3439832409262657, 0.34046265449523927, 0.33927161574363707, 0.34191692173480986, 0.3423330867767334, 0.34191631751060486, 0.3421250489711761, 0.3398388526916504, 0.3364105575799942, 0.33644406623840334, 0.3380864371299744, 0.3377282194852829, 0.33402248916625976, 0.3413435759305954, 0.3349744519233704, 0.33286320791244506, 0.33981006615161896, 0.33366800241470335, 0.33391638038158417, 0.33321113314628603, 0.32963919954299925, 0.33633562026023867]
history_ESGD15_s5 = history_ESGD15_s5[:len(x_ESGD15_avg)]


# # seed 6:
# ema:
ema_ESGD15_s6 = [2.2297880294799803, 2.229788029479981, 2.1624648572921754, 2.0367154102516176, 1.9114318344669345, 1.7955274964544299, 1.686669588327389, 1.5858285663175413, 1.4934888172287788, 1.4094071077185018, 1.3317436273143122, 1.2610686987726774, 1.196065207534631, 1.1355971138479708, 1.081151461129403, 1.0313927289864564, 0.9847142213160822, 0.9419131405521955, 0.9031210078867846, 0.8660496942894972, 0.8331237903550849, 0.8021456802614557, 0.7734129109222914, 0.7470346112965844, 0.7231791975616785, 0.7002532095586692, 0.6797123980231972, 0.6609016660691402, 0.6431825610447915, 0.6265155381079607, 0.611724265926727, 0.5972901243272261, 0.5843285232218656, 0.5728847127669352, 0.5624818634384839, 0.5517530521184774, 0.5428978521588956, 0.5340484003785415, 0.5255230545690505, 0.5172209071645899, 0.5096154837378648, 0.5022589451010931, 0.49603855815552855, 0.4899767022999214, 0.48430859719444097, 0.47835947576578364, 0.4731598918671838, 0.4686051854439466, 0.46394333772551016, 0.46053830234430126, 0.45609091281612424, 0.4524918651555751, 0.4486240368725158, 0.4451050353325573, 0.4416580773410649, 0.43800295092142677, 0.4349717396057581, 0.4315153646478297, 0.4295297241028465, 0.42694890156057336, 0.42419348419428043, 0.4214469341366307, 0.418831605153872, 0.4165616531135977, 0.4143748520734019, 0.4120487056960559, 0.40954140470176004, 0.40728681280030965, 0.40521131505680824, 0.40300225112658217, 0.4015235960288776, 0.3996068566003978, 0.3992930676650589, 0.3973379829268085, 0.39617717034045696, 0.3942785946514354, 0.3928526062953006, 0.39132118264325244, 0.38988500481147575, 0.38857167480199645, 0.3869064528460125, 0.3852732048792976, 0.3837270050159101, 0.38228522738257087, 0.38136630096589663, 0.38006650282044835, 0.378767476828393, 0.3773455677552492, 0.37611536270053425, 0.37565702060524736, 0.3752025983661185, 0.3738267960175667, 0.37247692958815043, 0.3722330738237781, 0.3706658490572527, 0.369371535276844, 0.36817807772112543, 0.36726575870710004, 0.3662610753696924, 0.3651209552265792, 0.3653482600716581, 0.36446673354993736, 0.36386538751027414, 0.3631703087344893, 0.3625624607481177, 0.36111066441276213, 0.3602872660184372, 0.35949221410016435, 0.35882890996271566, 0.3575915223348218, 0.3564040040220091, 0.355402569140667, 0.354407895093269, 0.35376212394217266, 0.3533544704149331, 0.35286802480013657, 0.3517263379388287, 0.3507003395056636, 0.34959360427641073, 0.34904436128422495, 0.34829754605786395, 0.34756872503724445, 0.3466172026792176, 0.3459243569754667, 0.3459615521678126, 0.3460256766541716, 0.3450348042426035, 0.3440403310386114, 0.34322233669231295, 0.34254375381472674, 0.342247565119293, 0.34182788456275465, 0.3410860992145038, 0.3404684177164581, 0.3403919670037341, 0.3397547542654197, 0.3389051857593108, 0.3388954302944942, 0.33803359176619685, 0.3373869505742535, 0.3369427364891182]
ema_ESGD15_s6 = ema_ESGD15_s6[:len(x_ESGD15_avg)]

x_ESGD15_s6 = x_ESGD15_avg
# x:
# [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000, 53500, 54000, 54500, 55000, 55500, 56000, 56500, 57000, 57500, 58000, 58500, 59000, 59500, 60000, 60500, 61000, 61500, 62000, 62500, 63000, 63500, 64000, 64500, 65000, 65500, 66000, 66500, 67000, 67500, 68000, 68500, 69000, 69500, 70000]

# history:
history_ESGD15_s6 = [2.2297880294799803, 1.5565563076019286, 0.9049703868865967, 0.7838796524047852, 0.7523884543418884, 0.706948415184021, 0.6782593682289123, 0.6624310754299164, 0.6526717221260071, 0.6327723036766052, 0.6249943418979644, 0.611033786392212, 0.5913842706680298, 0.5911405866622925, 0.5835641396999359, 0.5646076522827148, 0.5567034136772155, 0.5539918138980865, 0.5324078719139099, 0.5367906549453735, 0.5233426894187927, 0.5148179868698121, 0.5096299146652221, 0.508480473947525, 0.4939193175315857, 0.49484509420394895, 0.49160507848262786, 0.48371061582565306, 0.47651233167648316, 0.4786028162956238, 0.4673828499317169, 0.46767411327362063, 0.46989041867256165, 0.4688562194824219, 0.45519375023841857, 0.4632010525226593, 0.4544033343553543, 0.44879494228363037, 0.4425015805244446, 0.44116667289733885, 0.4360500973701477, 0.44005507564544677, 0.43541999959945676, 0.4332956512451172, 0.4248173829078674, 0.42636363677978517, 0.4276128276348114, 0.4219867082595825, 0.4298929839134216, 0.4160644070625305, 0.4201004362106323, 0.41381358232498167, 0.4134340214729309, 0.4106354554176331, 0.40510681314468383, 0.40769083776473997, 0.400407990026474, 0.41165895919799805, 0.40372149868011475, 0.399394727897644, 0.3967279836177826, 0.3952936443090439, 0.39613208475112915, 0.3946936427116394, 0.391113388299942, 0.38697569575309754, 0.38699548568725584, 0.3865318353652954, 0.3831206757545471, 0.38821570014953616, 0.3823562017440796, 0.39646896724700925, 0.3797422202825546, 0.38572985706329344, 0.3771914134502411, 0.3800187110900879, 0.3775383697748184, 0.37695940432548525, 0.37675170471668246, 0.37191945524215697, 0.37057397317886354, 0.36981120624542235, 0.36930922868251803, 0.37309596321582794, 0.3683683195114136, 0.3670762428998947, 0.36454838609695434, 0.36504351720809936, 0.3715319417476654, 0.37111279821395876, 0.3614445748806, 0.36032813172340394, 0.3700383719444275, 0.3565608261585236, 0.3577227112531662, 0.3574369597196579, 0.35905488758087156, 0.3572189253330231, 0.3548598739385605, 0.3673940036773682, 0.3565329948544502, 0.35845327315330505, 0.3569145997524261, 0.35709182887077334, 0.3480444973945618, 0.3528766804695129, 0.3523367468357086, 0.3528591727256775, 0.34645503368377684, 0.34571633920669553, 0.34638965520858767, 0.345455828666687, 0.3479501835823059, 0.3496855886697769, 0.3484900142669678, 0.3414511561870575, 0.34146635360717775, 0.3396329872131348, 0.34410117435455323, 0.34157620902061464, 0.3410093358516693, 0.33805350145697594, 0.33968874564170837, 0.34629630889892576, 0.34660279703140257, 0.3361169525384903, 0.3350900722026825, 0.33586038757562636, 0.3364365079164505, 0.3395818668603897, 0.3380507595539093, 0.334410031080246, 0.3349092842340469, 0.3397039105892181, 0.33401983962059023, 0.33125906920433046, 0.33880763111114504, 0.3302770450115204, 0.3315671798467636, 0.3329448097229004]
history_ESGD15_s6 = history_ESGD15_s6[:len(x_ESGD15_avg)]



## for std graphs

# y (ema) average
list_of_ESGD_ys_ema = [ema_ESGD15_s1[:len(history_ESGD15_s1)], ema_ESGD15_s2[:len(history_ESGD15_s2)], ema_ESGD15_s3[:len(history_ESGD15_s3)]]
list_of_ESGD_ys_avg = [history_ESGD15_s1, history_ESGD15_s2, history_ESGD15_s3, history_ESGD15_s4, history_ESGD15_s5, history_ESGD15_s6]

y_ESGD15_avg = [sum(sub_list) / len(sub_list) for sub_list in zip(*list_of_ESGD_ys_avg)]

# y_std
y_ESGD15_std = np.mean([np.std(sub_list) for sub_list in zip(*list_of_ESGD_ys_avg)])


# ## PD 115 without Reg
# # seed 74
# ema_PD115_nr_s1 = [0.53825915, 0.5382591485977173, 0.5335141867399216, 0.5244838669896126, 0.508424261957407, 0.49281837619841096, 0.4797417111173272, 0.4696703362740577, 0.4636418707618863, 0.447998117278494, 0.43114286440951605, 0.42039907972523255, 0.4115504443690957, 0.40273636162690357, 0.3958662502206448, 0.38804983069632204, 0.37944798144817726, 0.369781239090446, 0.3597665607256443, 0.3520985674252585, 0.3466159699610301, 0.340463805042335, 0.33351753161188535, 0.3312950760647944, 0.3245880660884343, 0.31899329639727736, 0.31286365345646316, 0.3071719427901152, 0.3003992769120017, 0.3014283656774055, 0.30230561313314064, 0.30091641918375633, 0.29740216054518115, 0.29292793915866994, 0.2896727458792852, 0.285264773919397, 0.287017247457099, 0.28106967781078107, 0.28222847140513024, 0.27976502618207477, 0.2769962338299806, 0.2739082459531357, 0.26879439359207125, 0.27113963608711217, 0.2722828606793516, 0.27045282602571546, 0.2703919698023477, 0.2673431133529853, 0.26237769829940594, 0.26211472369174776, 0.25968666389829476, 0.2591705636553159, 0.2611346110438279, 0.2603800265254055, 0.2585913436050541, 0.2574413937123412, 0.2590286125354583, 0.26347287502401606, 0.265622621832909, 0.2646594220923977, 0.2593733228320715, 0.25601721320225335, 0.2579109327227491, 0.25813859011804624, 0.25268320118852466, 0.2565968502354742, 0.2579259576313604, 0.2577415646832802, 0.2534503765453355, 0.2556136751964202, 0.26259872360180414, 0.26430178621247946, 0.25914152507932964, 0.2627502505029915, 0.2617949209254097, 0.25616590633759895, 0.254591700030297, 0.2534724249776572, 0.2519329375925395, 0.25412112059319614, 0.2546068601202184, 0.2543689256064189, 0.25654250191021793, 0.26167801445456296, 0.2590089612519617, 0.2582155412419923, 0.26132174247362805, 0.2556130833672755, 0.25582638209288777, 0.2569670393338096, 0.2579240990522765, 0.25445823307424154, 0.2607423642479423, 0.26317994706657916, 0.2678893617942398, 0.26643724550197706, 0.26818498351624775, 0.2681307617883489, 0.2660552538091486, 0.26531653195511207, 0.2695292018940232, 0.27127007392855124, 0.2747816987140027, 0.2692325217100722, 0.26915851556415044, 0.268311285881591, 0.27148792497073904, 0.27370123879690733, 0.26591533407491236, 0.2644295720898073, 0.26360142189052355, 0.2618113782207964, 0.25700060661442264, 0.2566419047338413, 0.2579934062560779, 0.2611111338734969]
# x_PD115_nr_s1 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360, 64000, 64640, 65280, 65920, 66560, 67200, 67840, 68480, 69120, 69760, 70400, 71040, 71680, 72320, 72960, 73600]
# history_PD115_nr_s1 = [0.53825915, 0.49080953, 0.443211, 0.36388782, 0.3523654, 0.36205173, 0.37902796, 0.40938568, 0.30720434, 0.2794456, 0.32370502, 0.33191273, 0.32340962, 0.33403525, 0.31770205, 0.30203134, 0.28278056, 0.26963446, 0.28308663, 0.2972726, 0.28509432, 0.27100107, 0.31129298, 0.26422498, 0.26864037, 0.25769687, 0.25594655, 0.23944528, 0.31069016, 0.31020084, 0.28841367, 0.26577383, 0.25265995, 0.260376, 0.24559303, 0.3027895, 0.22754155, 0.2926576, 0.25759402, 0.2520771, 0.24611636, 0.22276972, 0.29224682, 0.28257188, 0.2539825, 0.26984426, 0.2399034, 0.21768896, 0.25974795, 0.23783413, 0.25452566, 0.27881104, 0.25358877, 0.2424932, 0.24709184, 0.27331358, 0.30347124, 0.28497034, 0.25599062, 0.21179843, 0.22581223, 0.2749544, 0.2601875, 0.2035847, 0.2918197, 0.26988792, 0.25608203, 0.21482968, 0.27508336, 0.32546416, 0.27962935, 0.21269917, 0.29522878, 0.25319695, 0.20550478, 0.24042384, 0.24339895, 0.23807755, 0.27381477, 0.25897852, 0.25222751, 0.2761047, 0.30789763, 0.23498748, 0.25107476, 0.28927755, 0.20423515, 0.25774607, 0.26723295, 0.26653764, 0.22326544, 0.31729954, 0.2851182, 0.3102741, 0.2533682, 0.28391463, 0.26764277, 0.24737568, 0.25866804, 0.30744323, 0.28693792, 0.30638632, 0.21928993, 0.26849246, 0.26068622, 0.30007768, 0.29362106, 0.19584219, 0.2510577, 0.25614807, 0.24570099, 0.21370366, 0.2534136, 0.27015692, 0.28917068]

# # seed 2
# ema_PD115_nr_s2 = [0.5473518, 0.5473517775535583, 0.5402607470750809, 0.5251414522528648, 0.5102604131400585, 0.4963261425942183, 0.47891857389658693, 0.46436224428460005, 0.4477976088015288, 0.4380901835222289, 0.4232771767848055, 0.41092221203505874, 0.39728556212538374, 0.3888550412960699, 0.38142729809652426, 0.3735586107740163, 0.3668776602419638, 0.35736872710637063, 0.3519537921951873, 0.3479567268079516, 0.3398611186670658, 0.3317041372115073, 0.32566020263922135, 0.3209116849931352, 0.316525613692308, 0.31401627250931075, 0.31345795084614825, 0.30766024729233327, 0.30855697876770505, 0.30271827715539223, 0.30218372527870496, 0.2950261707673636, 0.2955561973664314, 0.2937411842953996, 0.2907057146619412, 0.2924574023834454, 0.2861553242520917, 0.2863660106703427, 0.28389690366191744, 0.27932278853776826, 0.2788091797422419, 0.2713693990222558, 0.2705563796083878, 0.2722408824432567, 0.26792829960006553, 0.2653325667627282, 0.2665265206081534, 0.26950778695191724, 0.2692321371934931, 0.2703472762020338, 0.274105428640119, 0.2716416454172776, 0.27035515330940296, 0.2737472041491551, 0.26743007010613823, 0.26694754039998303, 0.27141270586033567, 0.27065027846258793, 0.26463773334051893, 0.2648172839047825, 0.2647971776332541, 0.26402400438839946, 0.264088188155187, 0.2642153333518143, 0.26986197807430345, 0.2715942041102569, 0.2727113523504306, 0.26532814578007186, 0.2654476881842958, 0.26340556479881533, 0.26219843629649575, 0.2658739608852681, 0.26669790944414884, 0.2663426661577006, 0.26848462498958525, 0.2711688424060549, 0.27069295450238634, 0.2709895611183785, 0.2650105244258293, 0.26118863698893025, 0.2663745738004437, 0.26850625189555805, 0.27064452152621554, 0.27420954627846306, 0.2697170158301707, 0.27025847852899876, 0.2683088977993212, 0.2722358137244596, 0.2718813684470606, 0.2735689163405137, 0.27477539600715967, 0.2742342533628875, 0.278878040489024, 0.27803439561408705, 0.2737471818674977, 0.26606530187273403, 0.2626559338367973, 0.26047147375914403, 0.25458673741733684, 0.2544338802067845, 0.25771877165750345, 0.25211421247824145, 0.2526441746637593, 0.2517296329455409, 0.25009499686808884, 0.25124567178951057, 0.25112894858181195, 0.252607950734434, 0.2568098090595044, 0.2580942942952547, 0.2612145484318227, 0.2621195770051977, 0.26444520563604546, 0.265619668460388, 0.2662753818301848, 0.26825914602295975]
# x_PD115_nr_s2 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360, 64000, 64640, 65280, 65920, 66560, 67200, 67840, 68480, 69120, 69760, 70400, 71040, 71680, 72320, 72960, 73600]
# history_PD115_nr_s2 = [0.5473518, 0.47644147, 0.3890678, 0.37633106, 0.3709177, 0.32225046, 0.33335528, 0.2987159, 0.35072336, 0.28996012, 0.29972753, 0.2745557, 0.31298035, 0.3145776, 0.30274042, 0.3067491, 0.27178833, 0.30321938, 0.31198314, 0.26700065, 0.2582913, 0.2712648, 0.27817503, 0.27705097, 0.2914322, 0.30843306, 0.25548092, 0.31662756, 0.25016996, 0.29737276, 0.23060818, 0.30032644, 0.27740607, 0.2633865, 0.3082226, 0.22943662, 0.2882622, 0.26167494, 0.23815575, 0.2741867, 0.20441137, 0.2632392, 0.2874014, 0.22911505, 0.24197097, 0.2772721, 0.29633918, 0.2667513, 0.28038353, 0.3079288, 0.2494676, 0.25877672, 0.30427566, 0.21057586, 0.26260477, 0.3115992, 0.26378843, 0.21052483, 0.26643324, 0.26461622, 0.25706545, 0.26466584, 0.26535964, 0.32068178, 0.28718424, 0.2827657, 0.19887929, 0.26652357, 0.24502645, 0.25133428, 0.29895368, 0.27411345, 0.26314548, 0.28776225, 0.2953268, 0.26640996, 0.27365902, 0.2111992, 0.22679165, 0.313048, 0.28769135, 0.28988895, 0.30629477, 0.22928424, 0.27513164, 0.25076267, 0.30757806, 0.26869136, 0.28875685, 0.2856337, 0.26936397, 0.32067212, 0.2704416, 0.23516226, 0.19692838, 0.23197162, 0.24081133, 0.20162411, 0.25305817, 0.2872828, 0.20167318, 0.25741383, 0.24349876, 0.23538327, 0.26160175, 0.25007844, 0.26591897, 0.29462653, 0.26965466, 0.28929684, 0.27026483, 0.28537586, 0.27618983, 0.2721768, 0.28611302]

# # seed 3
# ema_PD115_nr_s3 = [0.57946855, 0.5794685482978821, 0.5636265248060226, 0.5468786123394966, 0.527707370787859, 0.5073469066649676, 0.4898790404823423, 0.4802688943410219, 0.4678778457997115, 0.4571485526881699, 0.4462736047079043, 0.4243837860318908, 0.41034941379066314, 0.40126593265386823, 0.3885365815769351, 0.3764314316341922, 0.36627549492981837, 0.3565525671571506, 0.35497473127216217, 0.34870242577704896, 0.34713322372954886, 0.3359381164764327, 0.3289476906348731, 0.32330506221259825, 0.31505464919631354, 0.3069966740151465, 0.30056450576247756, 0.2944672820925294, 0.2956419126355272, 0.29318688239129975, 0.292068698335939, 0.2897574141585112, 0.2913900019195628, 0.28733606947663, 0.2875977588880292, 0.28514291940822284, 0.2833928027632303, 0.2804640345766366, 0.27601037588663885, 0.2734998419906019, 0.27076330974924434, 0.27158588345552565, 0.2725173161241866, 0.2716413610410801, 0.27054481267024083, 0.2705285330929369, 0.26918846490842196, 0.2715147536056825, 0.2705193133107652, 0.2677983898775425, 0.27258918215542854, 0.27399786588290176, 0.2775171990103022, 0.2727296496844139, 0.27257882166646535, 0.27189923175045205, 0.2688315258729609, 0.26941043254507946, 0.26607168719267876, 0.26514404420640497, 0.26825859312343386, 0.26839350310678295, 0.2683550862763674, 0.26846070721396964, 0.2781685170648917, 0.2769079515741847, 0.2764268287485762, 0.27334422038190875, 0.26912951319986567, 0.26430121972776044, 0.26611269934132625, 0.26392446687658067, 0.2633645450845906, 0.2685385628738, 0.2680381969390506, 0.27005091927452635, 0.26886335571411624, 0.26903978192630446, 0.2687550086124811, 0.2663895456502503, 0.2677021892526447, 0.2660690103464156, 0.263456975325301, 0.25981229535134553, 0.26370248190812995, 0.2675330399774259, 0.27031408482516517, 0.26608066171757616, 0.2674888140888712, 0.2640312105654211, 0.261396602413523, 0.2607840767098676, 0.25900614445744846, 0.26059314774279796, 0.2612297877681703, 0.26051680252067305, 0.2560387611846214, 0.2569277638608294, 0.24870868811733218, 0.25311924180144096, 0.258042438275403, 0.25743015120636187, 0.26086932280848113, 0.25928615354767165, 0.26509926757160474, 0.2691566202724902, 0.2659640881733532, 0.26677707493154124, 0.265122032104563, 0.2697071903395336, 0.2658011442525102, 0.2713424169513208, 0.2719460788511594, 0.28226981131524087, 0.2850073865201197, 0.2940020553302278]
# x_PD115_nr_s3 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360, 64000, 64640, 65280, 65920, 66560, 67200, 67840, 68480, 69120, 69760, 70400, 71040, 71680, 72320, 72960, 73600]
# history_PD115_nr_s3 = [0.57946855, 0.4210483, 0.3961474, 0.3551662, 0.32410273, 0.33266824, 0.39377758, 0.3563584, 0.3605849, 0.34839907, 0.22737542, 0.28404006, 0.3195146, 0.27397242, 0.26748508, 0.27487206, 0.26904622, 0.3407742, 0.29225168, 0.3330104, 0.23518215, 0.26603386, 0.2725214, 0.24080093, 0.2344749, 0.24267499, 0.23959227, 0.3062136, 0.2710916, 0.28200504, 0.26895586, 0.3060833, 0.25085068, 0.28995296, 0.26304936, 0.26764175, 0.25410512, 0.23592745, 0.25090504, 0.24613452, 0.27898905, 0.2809002, 0.26375777, 0.26067588, 0.27038202, 0.25712785, 0.29245135, 0.26156035, 0.24331008, 0.3157063, 0.28667602, 0.3091912, 0.2296417, 0.27122137, 0.26578292, 0.24122217, 0.2746206, 0.23602298, 0.25679526, 0.29628953, 0.2696077, 0.26800933, 0.2694113, 0.3655388, 0.26556286, 0.27209672, 0.24560075, 0.23119715, 0.22084658, 0.28241602, 0.24423037, 0.25832525, 0.31510472, 0.2635349, 0.28816542, 0.25817528, 0.27062762, 0.26619205, 0.24510038, 0.27951598, 0.2513704, 0.23994866, 0.22701018, 0.29871416, 0.30200806, 0.2953435, 0.22797985, 0.2801622, 0.23291278, 0.23768513, 0.25527135, 0.24300475, 0.27487618, 0.26695955, 0.25409994, 0.21573639, 0.2649288, 0.174737, 0.29281422, 0.3023512, 0.25191957, 0.29182187, 0.24503763, 0.3174173, 0.3056728, 0.2372313, 0.27409396, 0.25022665, 0.3109736, 0.23064673, 0.32121387, 0.27737904, 0.3751834, 0.30964556, 0.37495407]


x_PD_115_avg = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120]


## PD 115 without Reg
# seed 74
ema_PD115_nr_s1 = [0.53825915, 0.5382591485977173, 0.5335141867399216, 0.5244838669896126, 0.508424261957407, 0.49281837619841096, 0.4797417111173272, 0.4696703362740577, 0.4636418707618863, 0.447998117278494, 0.43114286440951605, 0.42039907972523255, 0.4115504443690957, 0.40273636162690357, 0.3958662502206448, 0.38804983069632204, 0.37944798144817726, 0.369781239090446, 0.3597665607256443, 0.3520985674252585, 0.3466159699610301, 0.340463805042335, 0.33351753161188535, 0.3312950760647944, 0.3245880660884343, 0.31899329639727736, 0.31286365345646316, 0.3071719427901152, 0.3003992769120017, 0.3014283656774055, 0.30230561313314064, 0.30091641918375633, 0.29740216054518115, 0.29292793915866994, 0.2896727458792852, 0.285264773919397, 0.287017247457099, 0.28106967781078107, 0.28222847140513024, 0.27976502618207477, 0.2769962338299806, 0.2739082459531357, 0.26879439359207125, 0.27113963608711217, 0.2722828606793516, 0.27045282602571546, 0.2703919698023477, 0.2673431133529853, 0.26237769829940594, 0.26211472369174776, 0.25968666389829476, 0.2591705636553159, 0.2611346110438279, 0.2603800265254055, 0.2585913436050541, 0.2574413937123412, 0.2590286125354583, 0.26347287502401606, 0.265622621832909, 0.2646594220923977, 0.2593733228320715, 0.25601721320225335, 0.2579109327227491, 0.25813859011804624, 0.25268320118852466, 0.2565968502354742, 0.2579259576313604, 0.2577415646832802, 0.2534503765453355, 0.2556136751964202, 0.26259872360180414, 0.26430178621247946, 0.25914152507932964, 0.2627502505029915, 0.2617949209254097, 0.25616590633759895, 0.254591700030297, 0.2534724249776572, 0.2519329375925395, 0.25412112059319614, 0.2546068601202184, 0.2543689256064189, 0.25654250191021793, 0.26167801445456296, 0.2590089612519617, 0.2582155412419923, 0.26132174247362805, 0.2556130833672755, 0.25582638209288777, 0.2569670393338096, 0.2579240990522765, 0.25445823307424154, 0.2607423642479423, 0.26317994706657916, 0.2678893617942398, 0.26643724550197706, 0.26818498351624775, 0.2681307617883489, 0.2660552538091486, 0.26531653195511207, 0.2695292018940232, 0.27127007392855124, 0.2747816987140027, 0.2692325217100722, 0.26915851556415044, 0.268311285881591, 0.27148792497073904, 0.27370123879690733, 0.26591533407491236, 0.2644295720898073, 0.26360142189052355, 0.2618113782207964, 0.25700060661442264, 0.2566419047338413, 0.2579934062560779, 0.2611111338734969]
ema_PD115_nr_s1 = ema_PD115_nr_s1[:len(x_PD_115_avg)]

x_PD115_nr_s1 = x_PD_115_avg

history_PD115_nr_s1 = [0.53825915, 0.49080953, 0.443211, 0.36388782, 0.3523654, 0.36205173, 0.37902796, 0.40938568, 0.30720434, 0.2794456, 0.32370502, 0.33191273, 0.32340962, 0.33403525, 0.31770205, 0.30203134, 0.28278056, 0.26963446, 0.28308663, 0.2972726, 0.28509432, 0.27100107, 0.31129298, 0.26422498, 0.26864037, 0.25769687, 0.25594655, 0.23944528, 0.31069016, 0.31020084, 0.28841367, 0.26577383, 0.25265995, 0.260376, 0.24559303, 0.3027895, 0.22754155, 0.2926576, 0.25759402, 0.2520771, 0.24611636, 0.22276972, 0.29224682, 0.28257188, 0.2539825, 0.26984426, 0.2399034, 0.21768896, 0.25974795, 0.23783413, 0.25452566, 0.27881104, 0.25358877, 0.2424932, 0.24709184, 0.27331358, 0.30347124, 0.28497034, 0.25599062, 0.21179843, 0.22581223, 0.2749544, 0.2601875, 0.2035847, 0.2918197, 0.26988792, 0.25608203, 0.21482968, 0.27508336, 0.32546416, 0.27962935, 0.21269917, 0.29522878, 0.25319695, 0.20550478, 0.24042384, 0.24339895, 0.23807755, 0.27381477, 0.25897852, 0.25222751, 0.2761047, 0.30789763, 0.23498748, 0.25107476, 0.28927755, 0.20423515, 0.25774607, 0.26723295, 0.26653764, 0.22326544, 0.31729954, 0.2851182, 0.3102741, 0.2533682, 0.28391463, 0.26764277, 0.24737568, 0.25866804, 0.30744323, 0.28693792, 0.30638632, 0.21928993, 0.26849246, 0.26068622, 0.30007768, 0.29362106, 0.19584219, 0.2510577, 0.25614807, 0.24570099, 0.21370366, 0.2534136, 0.27015692, 0.28917068]
history_PD115_nr_s1 = history_PD115_nr_s1[:len(x_PD_115_avg)]

# seed 2
ema_PD115_nr_s2 = [0.5473518, 0.5473517775535583, 0.5402607470750809, 0.5251414522528648, 0.5102604131400585, 0.4963261425942183, 0.47891857389658693, 0.46436224428460005, 0.4477976088015288, 0.4380901835222289, 0.4232771767848055, 0.41092221203505874, 0.39728556212538374, 0.3888550412960699, 0.38142729809652426, 0.3735586107740163, 0.3668776602419638, 0.35736872710637063, 0.3519537921951873, 0.3479567268079516, 0.3398611186670658, 0.3317041372115073, 0.32566020263922135, 0.3209116849931352, 0.316525613692308, 0.31401627250931075, 0.31345795084614825, 0.30766024729233327, 0.30855697876770505, 0.30271827715539223, 0.30218372527870496, 0.2950261707673636, 0.2955561973664314, 0.2937411842953996, 0.2907057146619412, 0.2924574023834454, 0.2861553242520917, 0.2863660106703427, 0.28389690366191744, 0.27932278853776826, 0.2788091797422419, 0.2713693990222558, 0.2705563796083878, 0.2722408824432567, 0.26792829960006553, 0.2653325667627282, 0.2665265206081534, 0.26950778695191724, 0.2692321371934931, 0.2703472762020338, 0.274105428640119, 0.2716416454172776, 0.27035515330940296, 0.2737472041491551, 0.26743007010613823, 0.26694754039998303, 0.27141270586033567, 0.27065027846258793, 0.26463773334051893, 0.2648172839047825, 0.2647971776332541, 0.26402400438839946, 0.264088188155187, 0.2642153333518143, 0.26986197807430345, 0.2715942041102569, 0.2727113523504306, 0.26532814578007186, 0.2654476881842958, 0.26340556479881533, 0.26219843629649575, 0.2658739608852681, 0.26669790944414884, 0.2663426661577006, 0.26848462498958525, 0.2711688424060549, 0.27069295450238634, 0.2709895611183785, 0.2650105244258293, 0.26118863698893025, 0.2663745738004437, 0.26850625189555805, 0.27064452152621554, 0.27420954627846306, 0.2697170158301707, 0.27025847852899876, 0.2683088977993212, 0.2722358137244596, 0.2718813684470606, 0.2735689163405137, 0.27477539600715967, 0.2742342533628875, 0.278878040489024, 0.27803439561408705, 0.2737471818674977, 0.26606530187273403, 0.2626559338367973, 0.26047147375914403, 0.25458673741733684, 0.2544338802067845, 0.25771877165750345, 0.25211421247824145, 0.2526441746637593, 0.2517296329455409, 0.25009499686808884, 0.25124567178951057, 0.25112894858181195, 0.252607950734434, 0.2568098090595044, 0.2580942942952547, 0.2612145484318227, 0.2621195770051977, 0.26444520563604546, 0.265619668460388, 0.2662753818301848, 0.26825914602295975]
ema_PD115_nr_s2 = ema_PD115_nr_s2[:len(x_PD_115_avg)]

x_PD115_nr_s2 = x_PD_115_avg

history_PD115_nr_s2 = [0.5473518, 0.47644147, 0.3890678, 0.37633106, 0.3709177, 0.32225046, 0.33335528, 0.2987159, 0.35072336, 0.28996012, 0.29972753, 0.2745557, 0.31298035, 0.3145776, 0.30274042, 0.3067491, 0.27178833, 0.30321938, 0.31198314, 0.26700065, 0.2582913, 0.2712648, 0.27817503, 0.27705097, 0.2914322, 0.30843306, 0.25548092, 0.31662756, 0.25016996, 0.29737276, 0.23060818, 0.30032644, 0.27740607, 0.2633865, 0.3082226, 0.22943662, 0.2882622, 0.26167494, 0.23815575, 0.2741867, 0.20441137, 0.2632392, 0.2874014, 0.22911505, 0.24197097, 0.2772721, 0.29633918, 0.2667513, 0.28038353, 0.3079288, 0.2494676, 0.25877672, 0.30427566, 0.21057586, 0.26260477, 0.3115992, 0.26378843, 0.21052483, 0.26643324, 0.26461622, 0.25706545, 0.26466584, 0.26535964, 0.32068178, 0.28718424, 0.2827657, 0.19887929, 0.26652357, 0.24502645, 0.25133428, 0.29895368, 0.27411345, 0.26314548, 0.28776225, 0.2953268, 0.26640996, 0.27365902, 0.2111992, 0.22679165, 0.313048, 0.28769135, 0.28988895, 0.30629477, 0.22928424, 0.27513164, 0.25076267, 0.30757806, 0.26869136, 0.28875685, 0.2856337, 0.26936397, 0.32067212, 0.2704416, 0.23516226, 0.19692838, 0.23197162, 0.24081133, 0.20162411, 0.25305817, 0.2872828, 0.20167318, 0.25741383, 0.24349876, 0.23538327, 0.26160175, 0.25007844, 0.26591897, 0.29462653, 0.26965466, 0.28929684, 0.27026483, 0.28537586, 0.27618983, 0.2721768, 0.28611302]
history_PD115_nr_s2 = history_PD115_nr_s1[:len(x_PD_115_avg)]

# seed 3
ema_PD115_nr_s3 = [0.57946855, 0.5794685482978821, 0.5636265248060226, 0.5468786123394966, 0.527707370787859, 0.5073469066649676, 0.4898790404823423, 0.4802688943410219, 0.4678778457997115, 0.4571485526881699, 0.4462736047079043, 0.4243837860318908, 0.41034941379066314, 0.40126593265386823, 0.3885365815769351, 0.3764314316341922, 0.36627549492981837, 0.3565525671571506, 0.35497473127216217, 0.34870242577704896, 0.34713322372954886, 0.3359381164764327, 0.3289476906348731, 0.32330506221259825, 0.31505464919631354, 0.3069966740151465, 0.30056450576247756, 0.2944672820925294, 0.2956419126355272, 0.29318688239129975, 0.292068698335939, 0.2897574141585112, 0.2913900019195628, 0.28733606947663, 0.2875977588880292, 0.28514291940822284, 0.2833928027632303, 0.2804640345766366, 0.27601037588663885, 0.2734998419906019, 0.27076330974924434, 0.27158588345552565, 0.2725173161241866, 0.2716413610410801, 0.27054481267024083, 0.2705285330929369, 0.26918846490842196, 0.2715147536056825, 0.2705193133107652, 0.2677983898775425, 0.27258918215542854, 0.27399786588290176, 0.2775171990103022, 0.2727296496844139, 0.27257882166646535, 0.27189923175045205, 0.2688315258729609, 0.26941043254507946, 0.26607168719267876, 0.26514404420640497, 0.26825859312343386, 0.26839350310678295, 0.2683550862763674, 0.26846070721396964, 0.2781685170648917, 0.2769079515741847, 0.2764268287485762, 0.27334422038190875, 0.26912951319986567, 0.26430121972776044, 0.26611269934132625, 0.26392446687658067, 0.2633645450845906, 0.2685385628738, 0.2680381969390506, 0.27005091927452635, 0.26886335571411624, 0.26903978192630446, 0.2687550086124811, 0.2663895456502503, 0.2677021892526447, 0.2660690103464156, 0.263456975325301, 0.25981229535134553, 0.26370248190812995, 0.2675330399774259, 0.27031408482516517, 0.26608066171757616, 0.2674888140888712, 0.2640312105654211, 0.261396602413523, 0.2607840767098676, 0.25900614445744846, 0.26059314774279796, 0.2612297877681703, 0.26051680252067305, 0.2560387611846214, 0.2569277638608294, 0.24870868811733218, 0.25311924180144096, 0.258042438275403, 0.25743015120636187, 0.26086932280848113, 0.25928615354767165, 0.26509926757160474, 0.2691566202724902, 0.2659640881733532, 0.26677707493154124, 0.265122032104563, 0.2697071903395336, 0.2658011442525102, 0.2713424169513208, 0.2719460788511594, 0.28226981131524087, 0.2850073865201197, 0.2940020553302278]
ema_PD115_nr_s3 = ema_PD115_nr_s3[:len(x_PD_115_avg)]

x_PD115_nr_s3 = x_PD_115_avg

history_PD115_nr_s3 = [0.57946855, 0.4210483, 0.3961474, 0.3551662, 0.32410273, 0.33266824, 0.39377758, 0.3563584, 0.3605849, 0.34839907, 0.22737542, 0.28404006, 0.3195146, 0.27397242, 0.26748508, 0.27487206, 0.26904622, 0.3407742, 0.29225168, 0.3330104, 0.23518215, 0.26603386, 0.2725214, 0.24080093, 0.2344749, 0.24267499, 0.23959227, 0.3062136, 0.2710916, 0.28200504, 0.26895586, 0.3060833, 0.25085068, 0.28995296, 0.26304936, 0.26764175, 0.25410512, 0.23592745, 0.25090504, 0.24613452, 0.27898905, 0.2809002, 0.26375777, 0.26067588, 0.27038202, 0.25712785, 0.29245135, 0.26156035, 0.24331008, 0.3157063, 0.28667602, 0.3091912, 0.2296417, 0.27122137, 0.26578292, 0.24122217, 0.2746206, 0.23602298, 0.25679526, 0.29628953, 0.2696077, 0.26800933, 0.2694113, 0.3655388, 0.26556286, 0.27209672, 0.24560075, 0.23119715, 0.22084658, 0.28241602, 0.24423037, 0.25832525, 0.31510472, 0.2635349, 0.28816542, 0.25817528, 0.27062762, 0.26619205, 0.24510038, 0.27951598, 0.2513704, 0.23994866, 0.22701018, 0.29871416, 0.30200806, 0.2953435, 0.22797985, 0.2801622, 0.23291278, 0.23768513, 0.25527135, 0.24300475, 0.27487618, 0.26695955, 0.25409994, 0.21573639, 0.2649288, 0.174737, 0.29281422, 0.3023512, 0.25191957, 0.29182187, 0.24503763, 0.3174173, 0.3056728, 0.2372313, 0.27409396, 0.25022665, 0.3109736, 0.23064673, 0.32121387, 0.27737904, 0.3751834, 0.30964556, 0.37495407]
history_PD115_nr_s3 = history_PD115_nr_s3[:len(x_PD_115_avg)]

# # seed 4
ema_PD115_nr_s4 = [0.5832842, 0.5832841992378235, 0.5689490526914597, 0.5519647559523583, 0.543599363654852, 0.5235475717395545, 0.5027895794877411, 0.4873302096041144, 0.4726146829645724, 0.45719452552684164, 0.44132753180880563, 0.42665567070918575, 0.4168472028137204, 0.4099692347372434, 0.40259055281205725, 0.3879621951388456, 0.37573803620998303, 0.3663830920231126, 0.3558015880738302, 0.3509038023133222, 0.34300594317726585, 0.3328535463316348, 0.32785221391049985, 0.3225414882879969, 0.3146029216749832, 0.3142149033579259, 0.3119630827694859, 0.3083534342816227, 0.3053716572616178, 0.3003772037470649, 0.2972567025343457, 0.29087970794915075, 0.288796327784767, 0.2845051964596899, 0.2845825297065966, 0.28105776540294825, 0.27860006420483174, 0.27395723368528474, 0.2762025812787085, 0.27826739426156305, 0.2737501389595904, 0.27760913611767035, 0.28057275391802794, 0.28456937531100757, 0.2890889787030254, 0.29196600407529183, 0.2992631818965224, 0.29614666635827547, 0.2914656046185165, 0.2930861005026045, 0.2888825525794574, 0.29110318928547035, 0.2905401424430668, 0.2896236600753242, 0.28901283940165406, 0.2821639135523662, 0.2823939760068677, 0.27817255910095173, 0.2697878821717793, 0.27004596686605464, 0.26122515436628924, 0.2589557069833827, 0.25506633802912404, 0.25233647481794746, 0.2514288403647744, 0.2575128744296077, 0.2545230794178107, 0.2579414136612408, 0.25891852564251355, 0.25793684738846956, 0.26080700353955333, 0.2615588777915398, 0.2632078147222781, 0.2642338558694885, 0.2584148810500949, 0.25865404303625666, 0.26188553716917734, 0.26398526739638956, 0.26613255540932934, 0.2659597444570576, 0.2637972978982194, 0.26842724814112756, 0.26434138447727956, 0.2635492029549438, 0.2620183938230656, 0.25849432916810355, 0.2609631583515129, 0.26337854255050314, 0.264337609906285, 0.26455004873808236, 0.26266564306261553, 0.2656663332281329, 0.2668465769795612, 0.2688939717270168, 0.26821641446863703, 0.2649003400359907, 0.2654860407669269, 0.2639500818156233, 0.26492704941359435, 0.26877335602218455, 0.2675156226233352, 0.26967662547311566, 0.27048209882630153, 0.26735216298866193, 0.27257217990608146, 0.2737101825527948, 0.27476653568022863, 0.2675573314315684, 0.2663113580721564, 0.26117925553720717, 0.2605657968747752, 0.2561374018038634, 0.26050138557958513, 0.2626314975471012, 0.26356616476035527, 0.2667817699210919]
ema_PD115_nr_s4 = ema_PD115_nr_s4[:len(x_PD_115_avg)]

x_PD115_nr_s4 = x_PD_115_avg
# x_PD115_nr_s3 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360, 64000, 64640, 65280, 65920, 66560, 67200, 67840, 68480, 69120, 69760, 70400, 71040, 71680, 72320, 72960, 73600]

history_PD115_nr_s4 = [0.5832842, 0.43993273, 0.3991061, 0.46831083, 0.34308144, 0.31596765, 0.34819588, 0.34017494, 0.3184131, 0.2985246, 0.29460892, 0.328571, 0.34806752, 0.33618242, 0.25630698, 0.2657206, 0.2821886, 0.26056805, 0.30682373, 0.2719252, 0.24148197, 0.28284022, 0.27474496, 0.24315582, 0.31072274, 0.2916967, 0.2758666, 0.27853566, 0.25542712, 0.2691722, 0.23348676, 0.2700459, 0.24588501, 0.28527853, 0.24933489, 0.25648075, 0.23217176, 0.2964107, 0.2968507, 0.23309484, 0.3123401, 0.3072453, 0.32053897, 0.3297654, 0.31785923, 0.36493778, 0.26809803, 0.24933605, 0.30767056, 0.25105062, 0.31108892, 0.28547272, 0.28137532, 0.28351545, 0.22052358, 0.28446454, 0.2401798, 0.19432579, 0.27236873, 0.18183784, 0.23853068, 0.22006202, 0.2277677, 0.24326013, 0.31226918, 0.22761492, 0.28870642, 0.26771253, 0.24910174, 0.2866384, 0.26832575, 0.27804825, 0.27346823, 0.20604411, 0.2608065, 0.29096898, 0.28288284, 0.28545815, 0.26440445, 0.24433528, 0.3100968, 0.22756861, 0.25641957, 0.24824111, 0.22677775, 0.28318262, 0.285117, 0.27296922, 0.266462, 0.24570599, 0.29267254, 0.27746877, 0.28732052, 0.2621184, 0.23505567, 0.27075735, 0.25012645, 0.27371976, 0.30339012, 0.25619602, 0.28912565, 0.27773136, 0.23918274, 0.31955233, 0.2839522, 0.2842737, 0.2026745, 0.2550976, 0.21499033, 0.25504467, 0.21628185, 0.29977724, 0.2818025, 0.27197817, 0.29572222]
history_PD115_nr_s4 = history_PD115_nr_s4[:len(x_PD_115_avg)]


# # seed 5
# ema:
ema_PD115_nr_s5 = [0.5813548, 0.5813547968864441, 0.5700651735067368, 0.5647578594088555, 0.5493356129825115, 0.5384491689175368, 0.5227996117326618, 0.5103566980170906, 0.4932754101581306, 0.47632648011090734, 0.4645842176083539, 0.4519954766098095, 0.44672213005394634, 0.4308486551705381, 0.42579641377896493, 0.42430735620233795, 0.4161034762177471, 0.41004740947308577, 0.3989181168719152, 0.3964375061849373, 0.39213442829784306, 0.3808499577123215, 0.37649154387220357, 0.36844575752888276, 0.3610980899638607, 0.35222942157149384, 0.35292382410371365, 0.35310335491184053, 0.34720771194175176, 0.341416436559039, 0.3333007885152796, 0.33296042619359784, 0.32629622165750527, 0.32376775572649596, 0.31939197865085567, 0.3215470876123616, 0.3163187652074792, 0.3110380216756611, 0.3076732406901552, 0.30515435188000506, 0.3047465221493105, 0.30853576389628584, 0.3064926170797163, 0.31007131965378054, 0.30656015006976545, 0.3045731824184408, 0.3046062834452048, 0.30167035884175797, 0.29950135612351386, 0.2956453650939109, 0.28934047875532287, 0.28672349981423123, 0.28236724166830696, 0.2795421322771339, 0.2766070431996967, 0.27937343417372573, 0.2816964241751993, 0.2810586857398419, 0.2811156959176125, 0.282579101697212, 0.28652144751751923, 0.2882565702361271, 0.2860301624562506, 0.2864257565879373, 0.2862750803002907, 0.28590800892435253, 0.28513437686374254, 0.28690666417488875, 0.28559652680345854, 0.2883461092190905, 0.28587827750536476, 0.28463781179630165, 0.27930319429913225, 0.27988474179636597, 0.27449449100492446, 0.2751778590535943, 0.26998736064337114, 0.27265338242681997, 0.27601351565687815, 0.2779722174397316, 0.2737539166561848, 0.2744257290082055, 0.27508903195710876, 0.2698220981680027, 0.26758169295096434, 0.2705903067741159, 0.27308913599431783, 0.2769437092332268, 0.28380374829067806, 0.2904331063040556, 0.2898930705912526, 0.29395433342405697, 0.29292034574701076, 0.28990152300912453, 0.2844825117723791, 0.28504749795228074, 0.28070916080859154, 0.28400886664736436, 0.2842078263456955, 0.2861474294866921, 0.2878582751219691, 0.28536326665865375, 0.2835269657896786, 0.2798140097969916, 0.28296909475154997, 0.28278957674348937, 0.2825445759544783, 0.2845499510988605, 0.2819369133196782, 0.284821819890962, 0.28719919171580016, 0.2884489707349092, 0.2843871991811708, 0.2841427786033018, 0.2868693139744398, 0.28314458578162766]
ema_PD115_nr_s5 = ema_PD115_nr_s5[:len(x_PD_115_avg)]

x_PD115_nr_s5 = x_PD_115_avg
# x:
# [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360, 64000, 64640, 65280, 65920, 66560, 67200, 67840, 68480, 69120, 69760, 70400, 71040, 71680, 72320, 72960, 73600]

# history:
history_PD115_nr_s5 = [0.5813548, 0.46845856, 0.51699203, 0.4105354, 0.44047117, 0.3819536, 0.39837047, 0.33954382, 0.3237861, 0.35890386, 0.3386968, 0.399262, 0.28798738, 0.38032624, 0.41090584, 0.34226856, 0.3555428, 0.29875448, 0.374112, 0.35340673, 0.27928972, 0.33726582, 0.29603368, 0.29496908, 0.2724114, 0.35917345, 0.35471913, 0.29414693, 0.28929496, 0.26025996, 0.32989717, 0.26631838, 0.30101156, 0.28000998, 0.34094307, 0.26926386, 0.26351133, 0.2773902, 0.28248435, 0.30107605, 0.34263894, 0.2881043, 0.34227964, 0.27495962, 0.28669047, 0.3049042, 0.27524704, 0.27998033, 0.26094145, 0.2325965, 0.2631707, 0.24316092, 0.25411615, 0.25019124, 0.30427095, 0.30260333, 0.27531904, 0.2816288, 0.29574975, 0.32200256, 0.30387267, 0.2659925, 0.2899861, 0.284919, 0.28260437, 0.2781717, 0.30285725, 0.2738053, 0.31309235, 0.2636678, 0.27347362, 0.23129164, 0.28511867, 0.22598223, 0.28132817, 0.22327287, 0.29664758, 0.3062547, 0.29560053, 0.23578921, 0.28047204, 0.28105876, 0.2224197, 0.24741805, 0.29766783, 0.2955786, 0.31163487, 0.3455441, 0.35009733, 0.28503275, 0.3305057, 0.28361446, 0.26273212, 0.23571141, 0.29013237, 0.24166413, 0.31370622, 0.28599846, 0.30360386, 0.3032559, 0.2629082, 0.26700026, 0.2463974, 0.31136486, 0.2811739, 0.28033957, 0.30259833, 0.25841957, 0.31078598, 0.30859554, 0.29969698, 0.24783126, 0.281943, 0.31140813, 0.24962203]
history_PD115_nr_s5 = history_PD115_nr_s5[:len(x_PD_115_avg)]

# # seed 6
# ema:
ema_PD115_nr_s6 = [0.5401251, 0.5401250720024109, 0.5292406111955643, 0.5187795755267144, 0.5049218860566617, 0.4897814745277167, 0.47332827936738736, 0.46163617692407977, 0.44952322353735874, 0.4370964137597261, 0.4248493046656291, 0.41752455512538916, 0.40588693809379967, 0.3984005748498723, 0.3910153865160005, 0.38001096183134225, 0.37126465082829985, 0.3640350768625658, 0.356214654713266, 0.35430903637652955, 0.34755472306232477, 0.34813080695707344, 0.33943017245029283, 0.3335062109294075, 0.3312515505727415, 0.3232603718557613, 0.3256204560147515, 0.32253254664660613, 0.3186242301409345, 0.31018123946889353, 0.3060933553186427, 0.30490219023889636, 0.30344367409109774, 0.3009516124519083, 0.30238840799859523, 0.3031943066835227, 0.2981483063626131, 0.29237891926120285, 0.28766087466851387, 0.28561307884194415, 0.2851333072507795, 0.2863918618015423, 0.2858625121997572, 0.2838654340583185, 0.278753722126314, 0.28224926091584174, 0.27819833365696023, 0.2772149879421355, 0.2715509344952311, 0.2701503017381137, 0.26885231246071806, 0.26538885303900617, 0.26085844488649945, 0.2664098100517039, 0.26682776719217105, 0.27064309874073805, 0.2661164017817033, 0.2665771674186575, 0.2642031175855328, 0.26045305099757277, 0.25877336174254206, 0.2604207740128451, 0.2607903908998144, 0.25955690425429095, 0.262831450836003, 0.2574716609741511, 0.2587495656632121, 0.2634714703401389, 0.26170359050993286, 0.25920575257328893, 0.25660506096054087, 0.26103075331362163, 0.2608025817803628, 0.25417952526200593, 0.25743884553243623, 0.2539153296625308, 0.25791146745166404, 0.25808531096471454, 0.2554099728246907, 0.2565323117000204, 0.2614968153198667, 0.2607650815570451, 0.25919307849920664, 0.2569655708859879, 0.25473527899895776, 0.2517479088143826, 0.2539393329235602, 0.25403909000271757, 0.2562989423797804, 0.2552368146294008, 0.2550521107417628, 0.25555495130142136, 0.2535527918379357, 0.2551649010456369, 0.25440730270237616, 0.25916229441604816, 0.2602570839659137, 0.25916885774753357, 0.25990045167286874, 0.26504687753867817, 0.2690063144643758, 0.2658462130319763, 0.26585993498191435, 0.2638138934638369, 0.26755785685774097, 0.2658607787668384, 0.262599896798701, 0.25902755982593084, 0.25593989128096745, 0.2574617388924108, 0.263091408289684, 0.26091729975689637, 0.2688120994891154, 0.2818798506789292, 0.2810119615077572, 0.2822027676772711]
ema_PD115_nr_s6 = ema_PD115_nr_s6[:len(x_PD_115_avg)]

x_PD115_nr_s6 = x_PD_115_avg
# x:
# [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360, 64000, 64640, 65280, 65920, 66560, 67200, 67840, 68480, 69120, 69760, 70400, 71040, 71680, 72320, 72960, 73600]

# history:
history_PD115_nr_s6 = [0.5401251, 0.43128046, 0.42463025, 0.38020268, 0.35351777, 0.32524952, 0.35640725, 0.34050664, 0.32525513, 0.31462532, 0.3516018, 0.30114838, 0.3310233, 0.3245487, 0.28097114, 0.29254785, 0.2989689, 0.28583086, 0.33715847, 0.2867659, 0.35331556, 0.26112446, 0.28019056, 0.3109596, 0.25133976, 0.3468612, 0.29474136, 0.28344938, 0.23419432, 0.2693024, 0.2941817, 0.29031703, 0.27852306, 0.31531957, 0.3104474, 0.2527343, 0.24045444, 0.24519847, 0.26718292, 0.28081536, 0.29771885, 0.28109837, 0.26589173, 0.23274831, 0.3137091, 0.24173999, 0.26836488, 0.22057445, 0.2575446, 0.2571704, 0.23421772, 0.22008477, 0.3163721, 0.27058938, 0.30498108, 0.22537613, 0.27072406, 0.24283667, 0.22670245, 0.24365616, 0.27524748, 0.26411694, 0.24845552, 0.29230237, 0.20923355, 0.2702507, 0.3059686, 0.24579267, 0.23672521, 0.23319884, 0.30086198, 0.25874904, 0.19457202, 0.28677273, 0.22220369, 0.2938767, 0.2596499, 0.23133193, 0.26663336, 0.30617735, 0.25417948, 0.24504505, 0.236918, 0.23466265, 0.22486158, 0.27366215, 0.2549369, 0.2766376, 0.24567766, 0.25338978, 0.26008052, 0.23553336, 0.26967388, 0.24758892, 0.30195722, 0.2701102, 0.24937482, 0.2664848, 0.3113647, 0.30464125, 0.2374053, 0.26598343, 0.24539952, 0.30125353, 0.25058708, 0.23325196, 0.22687653, 0.22815087, 0.27115837, 0.31375843, 0.24135032, 0.3398653, 0.3994896, 0.27320096, 0.29292002]
history_PD115_nr_s6= history_PD115_nr_s6[:len(x_PD_115_avg)]



## for std graphs

# y (ema) average
list_of_PD_ys = [ema_PD115_nr_s1[:len(history_PD115_nr_s1)], ema_PD115_nr_s2[:len(history_PD115_nr_s2)], ema_PD115_nr_s3[:len(history_PD115_nr_s3)]]
y_PD_115_avg = [sum(sub_list) / len(sub_list) for sub_list in zip(*list_of_PD_ys)]

list_of_PD_ys_avg = [history_PD115_nr_s1, history_PD115_nr_s2, history_PD115_nr_s3, history_PD115_nr_s4, history_PD115_nr_s5, history_PD115_nr_s6]
y_PD_115_avg = [sum(sub_list) / len(sub_list) for sub_list in zip(*list_of_PD_ys_avg)]

# y_std
y_PD_115_std = np.mean([np.std(sub_list) for sub_list in zip(*list_of_PD_ys_avg)])





## KT RandomSearch
# this ema is actually history, not ema
ema_KT_s1 = [0.7, 0.7, 0.3428066670894623, 0.3308306336402893, 0.5133, 0.5133, 0.5133]
x_KT_s1 = [0, 47736, 47736, 48672, 48672 + 936]

ema_KT_s2 = [0.7, 0.7, 0.3382488489151001, 0.30403029918670654, 0.31463396549224854, 0.31585460901260376, 0.31585460901260376]
x_KT_s2 = [0, 47736, 47736, 48672, 48672 + 936, 48672 + 936 + 936]

ema_KT_s3 = [0.7, 0.7, 0.3934713900089264, 0.32653290033340454, 0.3017231822013855, 0.3618181645870209, 0.44951480627059937]
x_KT_s3 = [0, 47736, 47736, 48672, 48672 + 936, 48672 + 936 + 936, 48672 + 936 + 936 + 936]

# # seed 4
# # history
ema_KT_s4 = [0.7, 0.7, 0.3649950325489044, 0.3372732400894165, 0.5253260731697083, 0.5253260731697083, 0.5253260731697083]
x_KT_s4 = [0, 47736, 47736, 48672, 48672 + 936, 48672 + 936 + 936, 48672 + 936 + 936 + 936]
# # grad_steps
# [341.63535046577454, 315.68775272369385, 491.7052044868469, 1823.0367336273193]

# # seed 5
# # history
ema_KT_s5 = [0.7, 0.7, 0.35804483294487, 0.3233533203601837, 0.31584876775741577, 0.31092363595962524, 0.4087013602256775]
x_KT_s5 = [0, 47736, 47736, 48672, 48672 + 936, 48672 + 936 + 936, 48672 + 936 + 936 + 936]
# # grad steps
# [335.1299636363983, 302.65870785713196, 295.63444662094116, 291.02452325820923, 382.54447317123413, 430.86531829833984]


# # seed 6
# # history
ema_KT_s6 = [0.7, 0.7, 0.3426065444946289, 0.30897751450538635, 0.3063521981239319, 0.3936598300933838, 0.4955402612686157]
x_KT_s6 = [0, 47736, 47736, 48672, 48672 + 936, 48672 + 936 + 936, 48672 + 936 + 936 + 936]
# # grad_steps
# [320.67972564697266, 289.2029535770416, 286.74565744400024, 368.4656009674072, 463.8256845474243]


## for std graphs
# same x for all trials
x_KT_avg = [0, 47736, 47736, 48672, 48672 + 936, 48672 + 936 + 936, 48672 + 936 + 936 + 936]

# y (ema) average
list_of_KT_ys = [ema_KT_s1, ema_KT_s2, ema_KT_s3, ema_KT_s4, ema_KT_s5, ema_KT_s6]
y_KT_avg = [sum(sub_list) / len(sub_list) for sub_list in zip(*list_of_KT_ys)]

# y_std
y_KT_std = np.mean([np.std(sub_list) for sub_list in zip(*list_of_KT_ys)])



# # Sklearn Hyperopt
# # seed 1
ema_sklHO_s1 = [0.6, 0.6, 0.436116099357605, 0.4045725464820862, 0.4005056917667389, 0.397407591342926, 0.4280549883842468, 0.4280549883842468]

# # seed 2
ema_sklHO_s2 = [0.6, 0.6, 0.4299874007701874, 0.3953589200973511, 0.40258345007896423, 0.40258345007896423, 0.40258345007896423, 0.40258345007896423]

# # seed 3
ema_sklHO_s3 = [0.6, 0.6, 0.4303170442581177, 0.4089302122592926, 0.37652045488357544, 0.3812200725078583, 0.3812200725078583, 0.3812200725078583]

# # seed 4
ema_sklHO_s4 = [0.6, 0.6, 0.4713244140148163, 0.41869544982910156, 0.40306273102760315, 0.5484277009963989, 0.5484277009963989, 0.5484277009963989]

# # seed 5
ema_sklHO_s5 = [0.6, 0.6, 0.4686089754104614, 0.3824416697025299, 0.4378865659236908, 0.4378865659236908, 0.4378865659236908, 0.4378865659236908]

# # seed 6
ema_sklHO_s6 = [0.6, 0.6, 0.4488584101200104, 0.4201260209083557, 0.40478646755218506, 0.3803357183933258, 0.40225571393966675, 0.40225571393966675]

## for std graphs
# same x for all trials
x_sklHO_avg = [0, 46800, 46800, 48672 + 936, 48672 + 1872, 48672 + 2808, 48672 + 3744, 48672 + 4680]

# y (ema) average
list_of_sklHO_ys = [ema_sklHO_s1, ema_sklHO_s2, ema_sklHO_s3, ema_sklHO_s4, ema_sklHO_s5, ema_sklHO_s6]
y_sklHO_avg = [sum(sub_list) / len(sub_list) for sub_list in zip(*list_of_sklHO_ys)]

# y_std
y_sklHO_std = np.mean([np.std(sub_list) for sub_list in zip(*list_of_sklHO_ys)])




# KT Schedules FMNSIT without reg:
# seed 1
ema_KT_schedules_s1 = [0.8, 0.8, 0.33094877004623413, 0.2841227948665619, 0.26976579427719116, 0.2754004895687103, 0.2754004895687103, 0.2754004895687103]

# seed 2
ema_KT_schedules_s2 = [0.8, 0.8,0.33082860708236694, 0.30697813630104065, 0.28414303064346313, 0.27247560024261475, 0.2508482038974762, 0.2842411994934082]

# seed 3
ema_KT_schedules_s3 = [0.8, 0.8,0.33225658535957336, 0.2927878797054291, 0.2826632261276245, 0.26300421357154846, 0.26215845346450806, 0.27380073070526123]

# seed 4
ema_KT_schedules_s4 = [0.8, 0.8, 0.3374160826206207, 0.33423325419425964, 0.33346980810165405, 0.33279427886009216, 0.3322966694831848, 0.3261249363422394]

# seed 5
ema_KT_schedules_s5 = [0.8, 0.8,0.3493751883506775, 0.3064594864845276, 0.3326890170574188, 0.3326890170574188, 0.3326890170574188, 0.3326890170574188]

# seed 6
ema_KT_schedules_s6 = [0.8, 0.8, 0.3507264256477356, 0.29528671503067017, 0.2680191397666931, 0.2559022307395935, 0.25712037086486816, 0.25712037086486816]


# emas = [ema_KT_s1, ema_KT_s2, ema_KT_s3, ema_KT_s4, ema_KT_s5, ema_KT_s6]


## for std graphs
# same x for all trials
x_KT_schedules_avg = [0, 46800, 46800, 48672 + 936, 48672 + 1872, 48672 + 2808, 48672 + 3744, 48672 + 4680]

# y (ema) average
list_of_KT_schedules_ys = [ema_KT_schedules_s1, ema_KT_schedules_s2, ema_KT_schedules_s3, ema_KT_schedules_s4, ema_KT_schedules_s5, ema_KT_schedules_s6]
y_KT_schedules_avg = [sum(sub_list) / len(sub_list) for sub_list in zip(*list_of_KT_schedules_ys)]

# y_std
y_KT_schedules_std = np.mean([np.std(sub_list) for sub_list in zip(*list_of_KT_schedules_ys)])



# ## GS
# # seed 1
# ema_GS_s1 = [0.6622998, 0.6622998118400574, 0.6551180005073548, 0.6325066405534745, 0.6166335211396219, 0.6024816602051261, 0.5843874725323918, 0.5680581878979805, 0.5483955876254859, 0.5250101479492029, 0.5102536999524927, 0.49165910095047616, 0.48351086625520884, 0.47302050992010086, 0.46423614565275356, 0.4565559614635311, 0.44652326902182127, 0.43944440782455707, 0.4304234012996087, 0.42597947940542663, 0.42153325163109034, 0.4178155912409687, 0.41343624771688553, 0.40797530753362926, 0.4119357837106176, 0.40741353090394034, 0.4033024000148937, 0.40614313665219826, 0.4107644568370761, 0.40952697788062525, 0.4071556752417937, 0.40607270230303305, 0.40826614465817895, 0.4075472244605877, 0.40638765892256423, 0.40174085677447136, 0.3976630459497769, 0.3975649586561679, 0.3989570121088647, 0.39923643590083924, 0.391974698195498, 0.3886315828767188, 0.38793551977337304, 0.3881983851420364, 0.38022400394327777, 0.38078216721338637, 0.38125461348643247, 0.37923048742488336, 0.3788243365991889, 0.3829002350010376, 0.38186181212406467, 0.37890241406805314, 0.3792684423546225, 0.38379991778316175, 0.38283628280683224, 0.3851708327745545, 0.38063532605902684, 0.3804493054312736, 0.38154529969950945, 0.3886787424182334, 0.38629168537516345, 0.39082170069747224, 0.3908036012101148, 0.3956377886517025, 0.40139605547039303, 0.4001483852718645, 0.3942027123321033, 0.39404472096701887, 0.40420413062519217, 0.40520192723464715, 0.40883307940654534, 0.411523571195238, 0.4154062335926591, 0.42554356443032315, 0.43395486879776146, 0.4441894776382765, 0.45450895012248044, 0.4600375740006133, 0.476114146257153, 0.49020435721699374, 0.5012840358408449, 0.5088201518051766, 0.5143193264478095, 0.5252374106353802, 0.5311460519170418, 0.5315918407740284, 0.5494695140631874, 0.5569209188561333, 0.5691055891222381, 0.5780311081385574, 0.5814055788733925, 0.5825878848032683, 0.5907206358966108, 0.5949041029027291, 0.5982581061313619, 0.606830717521018, 0.6194393230054733, 0.6197804027116857, 0.6230873596653248, 0.6180355130420541]
# x_GS_s1 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360]
# history_GS_s1 = [0.6622998, 0.5904817, 0.4290044, 0.47377545, 0.4751149, 0.42153978, 0.42109463, 0.3714322, 0.3145412, 0.37744567, 0.3243077, 0.41017675, 0.3786073, 0.38517687, 0.3874343, 0.35622904, 0.37573466, 0.34923434, 0.38598418, 0.3815172, 0.38435665, 0.37402216, 0.35882685, 0.44758007, 0.36671326, 0.36630222, 0.43170977, 0.45235634, 0.39838967, 0.38581395, 0.39632595, 0.42800713, 0.40107694, 0.39595157, 0.35991964, 0.36096275, 0.39668217, 0.4114855, 0.40175125, 0.32661906, 0.35854355, 0.38167095, 0.39056417, 0.30845457, 0.38580564, 0.38550663, 0.36101335, 0.37516898, 0.41958332, 0.372516, 0.35226783, 0.3825627, 0.4245832, 0.37416357, 0.40618178, 0.33981577, 0.37877512, 0.39140925, 0.45287973, 0.36480817, 0.43159184, 0.3906407, 0.43914548, 0.45322046, 0.38891935, 0.34069166, 0.3926228, 0.49563882, 0.4141821, 0.44151345, 0.435738, 0.4503502, 0.51677954, 0.5096566, 0.53630096, 0.5473842, 0.5097952, 0.6208033, 0.61701626, 0.60100114, 0.5766452, 0.5638119, 0.62350017, 0.5843238, 0.53560394, 0.7103686, 0.62398356, 0.6787676, 0.6583608, 0.6117758, 0.59322864, 0.6639154, 0.6325553, 0.62844414, 0.6839842, 0.7329168, 0.6228501, 0.65285, 0.5725689]

# # seed 2
# ema_GS_s2 = [0.5962597, 0.5962597131729127, 0.5862633913755417, 0.574271374642849, 0.5628930363357069, 0.5583836048811676, 0.5491890230748059, 0.5334770159995259, 0.5173899957903356, 0.5003490146429656, 0.49163272944968794, 0.4820169922818111, 0.4704409912624389, 0.46053875464782984, 0.4534146724216867, 0.4467873607342895, 0.4405437440513482, 0.4394061652575949, 0.4309640247602778, 0.42819039991314867, 0.4276241717113464, 0.42767909980178553, 0.4259502364667715, 0.4224799847727234, 0.43327947045492066, 0.436584796772542, 0.4315967109198652, 0.4353301208968713, 0.432568029918291, 0.42972041042865916, 0.424733801533773, 0.4230983381122301, 0.4252979240998581, 0.4246202810572048, 0.4239436451166683, 0.42406871291129117, 0.4176761720072775, 0.4158316594503715, 0.41226464886746356, 0.40974231105400516, 0.4043411243678933, 0.40421067733065535, 0.4080205475553535, 0.4053410215912458, 0.4017421236996231, 0.399621748748217, 0.39737089320074975, 0.40315517941759343, 0.3956352993218271, 0.3897124282450826, 0.38797479140144747, 0.387116032249172, 0.38112009829858495, 0.37884733915251095, 0.3786663398735666, 0.38053195943769313, 0.3847547793716475, 0.3811759821471827, 0.38602125393425735, 0.3862550444639502, 0.39058153515190885, 0.3924212904435188, 0.40139512285546575, 0.40535230098625524, 0.4066083192091629, 0.41091986828399707, 0.4103567093612523, 0.40615477770582775, 0.4047108108700747, 0.4101842625351043, 0.40753815919857844, 0.41369159833224084, 0.4146821333375406, 0.4150359958475976, 0.4144549426495566, 0.41256962034638534, 0.41865067315282656, 0.4232185986535153, 0.42650307478574523, 0.43392424519718537, 0.43530232968205973, 0.43563493724711033, 0.44239041181845035, 0.4585773256937495, 0.47283987172125264, 0.47901571364115314, 0.49052161488751145, 0.49332151872354363, 0.4914506202558066, 0.5015005462425398, 0.5152855866900784, 0.5218567031995984, 0.5438774149158476, 0.5604444730763625, 0.5732226480679206, 0.5833196738037311, 0.5884387104516783, 0.5947939821009837, 0.6031745852164926, 0.6092841191112252]
# x_GS_s2 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360]
# history_GS_s2 = [0.5962597, 0.4962965, 0.46634322, 0.460488, 0.5177987, 0.4664378, 0.39206895, 0.3726068, 0.34698018, 0.41318616, 0.39547536, 0.36625698, 0.37141863, 0.38929793, 0.38714156, 0.3843512, 0.42916796, 0.35498476, 0.40322778, 0.42252812, 0.42817345, 0.41039047, 0.39124772, 0.53047484, 0.46633273, 0.38670394, 0.4689308, 0.4077092, 0.40409184, 0.37985432, 0.40837917, 0.4450942, 0.4185215, 0.41785392, 0.42519432, 0.3601433, 0.39923105, 0.38016155, 0.38704127, 0.35573044, 0.40303665, 0.44230938, 0.3812253, 0.36935204, 0.38053837, 0.3771132, 0.45521376, 0.32795638, 0.3364066, 0.37233606, 0.3793872, 0.3271567, 0.3583925, 0.37703735, 0.39732254, 0.42276016, 0.3489668, 0.4296287, 0.38835916, 0.42951995, 0.4089791, 0.4821596, 0.4409669, 0.41791248, 0.4497238, 0.40528828, 0.3683374, 0.3917151, 0.45944533, 0.38372323, 0.46907255, 0.42359695, 0.41822076, 0.40922546, 0.39560172, 0.47338015, 0.46432993, 0.45606336, 0.5007148, 0.4477051, 0.4386284, 0.5031897, 0.60425955, 0.6012028, 0.5345983, 0.5940747, 0.51852065, 0.47461253, 0.5919499, 0.63935095, 0.58099675, 0.7420638, 0.709548, 0.6882262, 0.6741929, 0.63451004, 0.6519914, 0.6786, 0.6642699]

# # seed 3
# ema_GS_s3 = [0.67397404, 0.6739740371704103, 0.6568124115467072, 0.6381259518861772, 0.6169694505333901, 0.5968571968853474, 0.5783523232918978, 0.5634517679675222, 0.5452338197884381, 0.5264811908356029, 0.504991274638624, 0.48666325947372713, 0.47255799836571755, 0.46812243461599123, 0.4572738188504294, 0.4411201695799037, 0.4334411430536989, 0.42283964826279435, 0.41689657873165803, 0.4184037092887062, 0.42119808586502355, 0.42123179369030256, 0.41878592133096926, 0.4170471324882395, 0.415408023687734, 0.419055496298552, 0.4165975612192873, 0.4130398805549315, 0.408583984578601, 0.40913308483804894, 0.40642213066618715, 0.39893980837048065, 0.4008443446413962, 0.39567247254755683, 0.38923797806894705, 0.3854160320829981, 0.3806587289635807, 0.3848105488000336, 0.38319380740326847, 0.3780893414616782, 0.37409354115130294, 0.372872697096483, 0.3730766833854462, 0.37149730274374, 0.37617931320632736, 0.37335201401441015, 0.37126111357446356, 0.36786214443179227, 0.3638213449609184, 0.36164219742046927, 0.36367395429337446, 0.36321586288682606, 0.3590905808002232, 0.361409676902635, 0.3609080012140957, 0.36854311187550015, 0.3712307753516846, 0.3670157917458069, 0.3753531272517072, 0.3754072095727707, 0.378128564874153, 0.3722391395448035, 0.3743402453075396, 0.37393996940349467, 0.37490944707061286, 0.37649493494926783, 0.37962696027128895, 0.3871631211462826, 0.38636054871289827, 0.38574231515355917, 0.3965068446102263, 0.41375410436116355, 0.4209040958749297, 0.42744035354856047, 0.44017487315777, 0.4507020433107888, 0.4507277506017573, 0.4570226994833846, 0.46043209085001047, 0.4638652758222833, 0.470550151743473, 0.4753083813887668, 0.4765320833356827, 0.48720744989797315, 0.5005585230215029, 0.514699227525917, 0.5355204584426826, 0.5395390905940961, 0.5504813120965151, 0.5688745492283095, 0.5803961974606147, 0.5870860775314478, 0.5958875977995433, 0.6034423378708158, 0.618469017827707, 0.6223978859938958, 0.6291924651942651, 0.6372225108577609, 0.6455752393156707, 0.6544029361501711]
# x_GS_s3 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360]
# history_GS_s3 = [0.67397404, 0.5023578, 0.46994781, 0.42656094, 0.4158469, 0.41180846, 0.42934677, 0.3812723, 0.35770753, 0.31158203, 0.32171112, 0.34561065, 0.42820236, 0.35963628, 0.29573733, 0.3643299, 0.3274262, 0.36340895, 0.43196788, 0.44634748, 0.42153516, 0.39677307, 0.40139803, 0.40065604, 0.45188275, 0.39447615, 0.38102075, 0.36848092, 0.414075, 0.38202354, 0.3315989, 0.41798517, 0.34912562, 0.33132753, 0.35101852, 0.337843, 0.42217693, 0.36864313, 0.33214915, 0.33813134, 0.3618851, 0.37491256, 0.35728288, 0.4183174, 0.34790632, 0.352443, 0.33727142, 0.32745415, 0.34202987, 0.38195977, 0.35909304, 0.32196304, 0.38228154, 0.35639292, 0.4372591, 0.39541975, 0.32908094, 0.45038915, 0.37589395, 0.40262076, 0.3192343, 0.3932502, 0.3703375, 0.38363475, 0.39076433, 0.4078152, 0.45498857, 0.3791374, 0.3801782, 0.4933876, 0.56897944, 0.48525402, 0.48626667, 0.55478555, 0.5454466, 0.45095912, 0.51367724, 0.4911166, 0.49476394, 0.53071404, 0.51813245, 0.4875454, 0.58328575, 0.6207182, 0.64196557, 0.72291154, 0.5757068, 0.6489613, 0.7344137, 0.68409103, 0.647295, 0.6751013, 0.671435, 0.75370914, 0.6577577, 0.6903437, 0.7094929, 0.7207498, 0.7338522]


x_GS_avg = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120]

## GS
# seed 1
ema_GS_s1 = [0.6622998, 0.6622998118400574, 0.6551180005073548, 0.6325066405534745, 0.6166335211396219, 0.6024816602051261, 0.5843874725323918, 0.5680581878979805, 0.5483955876254859, 0.5250101479492029, 0.5102536999524927, 0.49165910095047616, 0.48351086625520884, 0.47302050992010086, 0.46423614565275356, 0.4565559614635311, 0.44652326902182127, 0.43944440782455707, 0.4304234012996087, 0.42597947940542663, 0.42153325163109034, 0.4178155912409687, 0.41343624771688553, 0.40797530753362926, 0.4119357837106176, 0.40741353090394034, 0.4033024000148937, 0.40614313665219826, 0.4107644568370761, 0.40952697788062525, 0.4071556752417937, 0.40607270230303305, 0.40826614465817895, 0.4075472244605877, 0.40638765892256423, 0.40174085677447136, 0.3976630459497769, 0.3975649586561679, 0.3989570121088647, 0.39923643590083924, 0.391974698195498, 0.3886315828767188, 0.38793551977337304, 0.3881983851420364, 0.38022400394327777, 0.38078216721338637, 0.38125461348643247, 0.37923048742488336, 0.3788243365991889, 0.3829002350010376, 0.38186181212406467, 0.37890241406805314, 0.3792684423546225, 0.38379991778316175, 0.38283628280683224, 0.3851708327745545, 0.38063532605902684, 0.3804493054312736, 0.38154529969950945, 0.3886787424182334, 0.38629168537516345, 0.39082170069747224, 0.3908036012101148, 0.3956377886517025, 0.40139605547039303, 0.4001483852718645, 0.3942027123321033, 0.39404472096701887, 0.40420413062519217, 0.40520192723464715, 0.40883307940654534, 0.411523571195238, 0.4154062335926591, 0.42554356443032315, 0.43395486879776146, 0.4441894776382765, 0.45450895012248044, 0.4600375740006133, 0.476114146257153, 0.49020435721699374, 0.5012840358408449, 0.5088201518051766, 0.5143193264478095, 0.5252374106353802, 0.5311460519170418, 0.5315918407740284, 0.5494695140631874, 0.5569209188561333, 0.5691055891222381, 0.5780311081385574, 0.5814055788733925, 0.5825878848032683, 0.5907206358966108, 0.5949041029027291, 0.5982581061313619, 0.606830717521018, 0.6194393230054733, 0.6197804027116857, 0.6230873596653248, 0.6180355130420541]
ema_GS_s1 = ema_GS_s1[:len(x_GS_avg)]

x_GS_s1 = x_GS_avg

history_GS_s1 = [0.6622998, 0.5904817, 0.4290044, 0.47377545, 0.4751149, 0.42153978, 0.42109463, 0.3714322, 0.3145412, 0.37744567, 0.3243077, 0.41017675, 0.3786073, 0.38517687, 0.3874343, 0.35622904, 0.37573466, 0.34923434, 0.38598418, 0.3815172, 0.38435665, 0.37402216, 0.35882685, 0.44758007, 0.36671326, 0.36630222, 0.43170977, 0.45235634, 0.39838967, 0.38581395, 0.39632595, 0.42800713, 0.40107694, 0.39595157, 0.35991964, 0.36096275, 0.39668217, 0.4114855, 0.40175125, 0.32661906, 0.35854355, 0.38167095, 0.39056417, 0.30845457, 0.38580564, 0.38550663, 0.36101335, 0.37516898, 0.41958332, 0.372516, 0.35226783, 0.3825627, 0.4245832, 0.37416357, 0.40618178, 0.33981577, 0.37877512, 0.39140925, 0.45287973, 0.36480817, 0.43159184, 0.3906407, 0.43914548, 0.45322046, 0.38891935, 0.34069166, 0.3926228, 0.49563882, 0.4141821, 0.44151345, 0.435738, 0.4503502, 0.51677954, 0.5096566, 0.53630096, 0.5473842, 0.5097952, 0.6208033, 0.61701626, 0.60100114, 0.5766452, 0.5638119, 0.62350017, 0.5843238, 0.53560394, 0.7103686, 0.62398356, 0.6787676, 0.6583608, 0.6117758, 0.59322864, 0.6639154, 0.6325553, 0.62844414, 0.6839842, 0.7329168, 0.6228501, 0.65285, 0.5725689]
history_ESGD15_s1 = history_GS_s1[:len(x_GS_avg)]

# seed 2
ema_GS_s2 = [0.5962597, 0.5962597131729127, 0.5862633913755417, 0.574271374642849, 0.5628930363357069, 0.5583836048811676, 0.5491890230748059, 0.5334770159995259, 0.5173899957903356, 0.5003490146429656, 0.49163272944968794, 0.4820169922818111, 0.4704409912624389, 0.46053875464782984, 0.4534146724216867, 0.4467873607342895, 0.4405437440513482, 0.4394061652575949, 0.4309640247602778, 0.42819039991314867, 0.4276241717113464, 0.42767909980178553, 0.4259502364667715, 0.4224799847727234, 0.43327947045492066, 0.436584796772542, 0.4315967109198652, 0.4353301208968713, 0.432568029918291, 0.42972041042865916, 0.424733801533773, 0.4230983381122301, 0.4252979240998581, 0.4246202810572048, 0.4239436451166683, 0.42406871291129117, 0.4176761720072775, 0.4158316594503715, 0.41226464886746356, 0.40974231105400516, 0.4043411243678933, 0.40421067733065535, 0.4080205475553535, 0.4053410215912458, 0.4017421236996231, 0.399621748748217, 0.39737089320074975, 0.40315517941759343, 0.3956352993218271, 0.3897124282450826, 0.38797479140144747, 0.387116032249172, 0.38112009829858495, 0.37884733915251095, 0.3786663398735666, 0.38053195943769313, 0.3847547793716475, 0.3811759821471827, 0.38602125393425735, 0.3862550444639502, 0.39058153515190885, 0.3924212904435188, 0.40139512285546575, 0.40535230098625524, 0.4066083192091629, 0.41091986828399707, 0.4103567093612523, 0.40615477770582775, 0.4047108108700747, 0.4101842625351043, 0.40753815919857844, 0.41369159833224084, 0.4146821333375406, 0.4150359958475976, 0.4144549426495566, 0.41256962034638534, 0.41865067315282656, 0.4232185986535153, 0.42650307478574523, 0.43392424519718537, 0.43530232968205973, 0.43563493724711033, 0.44239041181845035, 0.4585773256937495, 0.47283987172125264, 0.47901571364115314, 0.49052161488751145, 0.49332151872354363, 0.4914506202558066, 0.5015005462425398, 0.5152855866900784, 0.5218567031995984, 0.5438774149158476, 0.5604444730763625, 0.5732226480679206, 0.5833196738037311, 0.5884387104516783, 0.5947939821009837, 0.6031745852164926, 0.6092841191112252]
ema_GS_s2 = ema_GS_s2[:len(x_GS_avg)]

x_GS_s2 = x_GS_avg

history_GS_s2 = [0.5962597, 0.4962965, 0.46634322, 0.460488, 0.5177987, 0.4664378, 0.39206895, 0.3726068, 0.34698018, 0.41318616, 0.39547536, 0.36625698, 0.37141863, 0.38929793, 0.38714156, 0.3843512, 0.42916796, 0.35498476, 0.40322778, 0.42252812, 0.42817345, 0.41039047, 0.39124772, 0.53047484, 0.46633273, 0.38670394, 0.4689308, 0.4077092, 0.40409184, 0.37985432, 0.40837917, 0.4450942, 0.4185215, 0.41785392, 0.42519432, 0.3601433, 0.39923105, 0.38016155, 0.38704127, 0.35573044, 0.40303665, 0.44230938, 0.3812253, 0.36935204, 0.38053837, 0.3771132, 0.45521376, 0.32795638, 0.3364066, 0.37233606, 0.3793872, 0.3271567, 0.3583925, 0.37703735, 0.39732254, 0.42276016, 0.3489668, 0.4296287, 0.38835916, 0.42951995, 0.4089791, 0.4821596, 0.4409669, 0.41791248, 0.4497238, 0.40528828, 0.3683374, 0.3917151, 0.45944533, 0.38372323, 0.46907255, 0.42359695, 0.41822076, 0.40922546, 0.39560172, 0.47338015, 0.46432993, 0.45606336, 0.5007148, 0.4477051, 0.4386284, 0.5031897, 0.60425955, 0.6012028, 0.5345983, 0.5940747, 0.51852065, 0.47461253, 0.5919499, 0.63935095, 0.58099675, 0.7420638, 0.709548, 0.6882262, 0.6741929, 0.63451004, 0.6519914, 0.6786, 0.6642699]
history_GS_s2 = history_GS_s2[:len(x_GS_avg)]

# seed 3
ema_GS_s3 = [0.67397404, 0.6739740371704103, 0.6568124115467072, 0.6381259518861772, 0.6169694505333901, 0.5968571968853474, 0.5783523232918978, 0.5634517679675222, 0.5452338197884381, 0.5264811908356029, 0.504991274638624, 0.48666325947372713, 0.47255799836571755, 0.46812243461599123, 0.4572738188504294, 0.4411201695799037, 0.4334411430536989, 0.42283964826279435, 0.41689657873165803, 0.4184037092887062, 0.42119808586502355, 0.42123179369030256, 0.41878592133096926, 0.4170471324882395, 0.415408023687734, 0.419055496298552, 0.4165975612192873, 0.4130398805549315, 0.408583984578601, 0.40913308483804894, 0.40642213066618715, 0.39893980837048065, 0.4008443446413962, 0.39567247254755683, 0.38923797806894705, 0.3854160320829981, 0.3806587289635807, 0.3848105488000336, 0.38319380740326847, 0.3780893414616782, 0.37409354115130294, 0.372872697096483, 0.3730766833854462, 0.37149730274374, 0.37617931320632736, 0.37335201401441015, 0.37126111357446356, 0.36786214443179227, 0.3638213449609184, 0.36164219742046927, 0.36367395429337446, 0.36321586288682606, 0.3590905808002232, 0.361409676902635, 0.3609080012140957, 0.36854311187550015, 0.3712307753516846, 0.3670157917458069, 0.3753531272517072, 0.3754072095727707, 0.378128564874153, 0.3722391395448035, 0.3743402453075396, 0.37393996940349467, 0.37490944707061286, 0.37649493494926783, 0.37962696027128895, 0.3871631211462826, 0.38636054871289827, 0.38574231515355917, 0.3965068446102263, 0.41375410436116355, 0.4209040958749297, 0.42744035354856047, 0.44017487315777, 0.4507020433107888, 0.4507277506017573, 0.4570226994833846, 0.46043209085001047, 0.4638652758222833, 0.470550151743473, 0.4753083813887668, 0.4765320833356827, 0.48720744989797315, 0.5005585230215029, 0.514699227525917, 0.5355204584426826, 0.5395390905940961, 0.5504813120965151, 0.5688745492283095, 0.5803961974606147, 0.5870860775314478, 0.5958875977995433, 0.6034423378708158, 0.618469017827707, 0.6223978859938958, 0.6291924651942651, 0.6372225108577609, 0.6455752393156707, 0.6544029361501711]
ema_GS_s3 = ema_GS_s3[:len(x_GS_avg)]

x_GS_s3 = x_GS_avg

history_GS_s3 = [0.67397404, 0.5023578, 0.46994781, 0.42656094, 0.4158469, 0.41180846, 0.42934677, 0.3812723, 0.35770753, 0.31158203, 0.32171112, 0.34561065, 0.42820236, 0.35963628, 0.29573733, 0.3643299, 0.3274262, 0.36340895, 0.43196788, 0.44634748, 0.42153516, 0.39677307, 0.40139803, 0.40065604, 0.45188275, 0.39447615, 0.38102075, 0.36848092, 0.414075, 0.38202354, 0.3315989, 0.41798517, 0.34912562, 0.33132753, 0.35101852, 0.337843, 0.42217693, 0.36864313, 0.33214915, 0.33813134, 0.3618851, 0.37491256, 0.35728288, 0.4183174, 0.34790632, 0.352443, 0.33727142, 0.32745415, 0.34202987, 0.38195977, 0.35909304, 0.32196304, 0.38228154, 0.35639292, 0.4372591, 0.39541975, 0.32908094, 0.45038915, 0.37589395, 0.40262076, 0.3192343, 0.3932502, 0.3703375, 0.38363475, 0.39076433, 0.4078152, 0.45498857, 0.3791374, 0.3801782, 0.4933876, 0.56897944, 0.48525402, 0.48626667, 0.55478555, 0.5454466, 0.45095912, 0.51367724, 0.4911166, 0.49476394, 0.53071404, 0.51813245, 0.4875454, 0.58328575, 0.6207182, 0.64196557, 0.72291154, 0.5757068, 0.6489613, 0.7344137, 0.68409103, 0.647295, 0.6751013, 0.671435, 0.75370914, 0.6577577, 0.6903437, 0.7094929, 0.7207498, 0.7338522]
history_GS_s3 = history_GS_s3[:len(x_GS_avg)]


# # seed 4

# history:
history_GS_s4 = [0.591261, 0.5001392, 0.41624784, 0.4417759, 0.38093597, 0.37267584, 0.36196294, 0.4020125, 0.34568062, 0.39176005, 0.34395206, 0.34418008, 0.34731895, 0.3202377, 0.33860564, 0.36158612, 0.3033678, 0.29133067, 0.37144002, 0.36696455, 0.37050256, 0.4374644, 0.422297, 0.39103094, 0.45708838, 0.3846193, 0.38189816, 0.4136684, 0.35875222, 0.38537452, 0.37932575, 0.4357421, 0.36395353, 0.39359826, 0.37043872, 0.35448194, 0.3889531, 0.36773467, 0.46812162, 0.423374, 0.37570077, 0.36328837, 0.36813894, 0.45598546, 0.42782924, 0.4391841, 0.3975444, 0.4100116, 0.39109096, 0.3794658, 0.37301883, 0.4141967, 0.41471502, 0.38530383, 0.41903982, 0.4231166, 0.35897455, 0.4205242, 0.49458024, 0.4835424, 0.38477042, 0.39729849, 0.42806813, 0.44188067, 0.42220983, 0.38911915, 0.50902796, 0.47817013, 0.4045206, 0.5052948, 0.52014506, 0.6213173, 0.60105634, 0.5503685, 0.62642145, 0.59802234, 0.5249955, 0.61186504, 0.540911, 0.54882187, 0.582998, 0.51764524, 0.549125, 0.5207361, 0.5250348, 0.5732609, 0.5340629, 0.5541153, 0.5542745, 0.54069775, 0.57106656, 0.6189578, 0.60017365, 0.6560747, 0.6132437, 0.55658644, 0.62768453, 0.6658331, 0.61641777]
history_GS_s4 = history_GS_s4[:len(x_GS_avg)]

# ema
ema_GS_s4 = [0.591261, 0.5912610292434692, 0.5821488440036774, 0.5655587440729142, 0.5531804584860802, 0.5359560093343259, 0.5196279920095206, 0.5038614872354866, 0.49367658823060406, 0.4788769918322034, 0.4701652977740288, 0.4575439739712048, 0.446207584305522, 0.4363187206064914, 0.424710618162923, 0.41610012057850326, 0.41064872089114396, 0.39992062815803237, 0.38906163187722514, 0.3872994710078849, 0.3852659787897182, 0.3837896370438259, 0.389157111961918, 0.39247110085422715, 0.3923270845121287, 0.3988032141661176, 0.39738482230921346, 0.39583615655320664, 0.39761938030676053, 0.39373266436299087, 0.3928968495515621, 0.3915397393453988, 0.3959599764122551, 0.3927593318498718, 0.39284322451441767, 0.3906027745386, 0.38699069063484987, 0.3871869305427699, 0.38524170455239676, 0.39352969590040265, 0.39651412603150804, 0.39443279060921965, 0.3913183488238028, 0.38900040785564527, 0.3956989127405901, 0.3989119450457471, 0.4029391604847531, 0.40239968581677854, 0.4031608761878137, 0.4019538845000855, 0.3997050749103599, 0.39703645052078723, 0.39875247545447967, 0.4003487300938996, 0.39884423959850956, 0.4008637972050878, 0.4030890769398784, 0.3986776238652982, 0.4008622824525461, 0.41023407811304563, 0.4175649115536866, 0.4142854627157084, 0.412586764948204, 0.4141349015742256, 0.416909478733812, 0.4174395137696334, 0.41460747721810953, 0.42404952528792456, 0.42946158542678803, 0.4269674869875257, 0.43480021826924187, 0.4433347023055074, 0.46113296477721194, 0.4751253020351475, 0.48264962061512584, 0.4970268037104736, 0.5071263575122473, 0.508913272342001, 0.5192084494718145, 0.521378706409475, 0.5241230224197574, 0.5300105179511428, 0.5287739901390303, 0.5308090926986898, 0.5298017932577698, 0.5293250924590619, 0.5337186735490016, 0.5337530983941899, 0.5357893180957866, 0.5376378362278431, 0.5379438279480001, 0.5412561009893054, 0.5490262726458223, 0.5541410105984489, 0.5643343798125755, 0.5692253117386971, 0.5679614250026173, 0.5739337358619595, 0.5831236738335334, 0.5864530830119171]
ema_GS_s4 = ema_GS_s4[:len(x_GS_avg)]

# x
# [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360]
x_GS_s4 = x_GS_avg

# # Seed 5:
history_GS_s5 = [0.5620124, 0.49587137, 0.41892844, 0.46923286, 0.42139563, 0.39412785, 0.3977971, 0.37386745, 0.36084777, 0.38414097, 0.3805236, 0.34655496, 0.39086172, 0.40858385, 0.37372324, 0.35606048, 0.38936412, 0.32988128, 0.37897095, 0.3653938, 0.3720499, 0.38247308, 0.39782742, 0.42878294, 0.37302342, 0.47196713, 0.50799406, 0.46281025, 0.47708288, 0.4284214, 0.47018424, 0.49936745, 0.49460822, 0.43563858, 0.50687665, 0.4829428, 0.47181988, 0.509414, 0.53118145, 0.53111553, 0.44462276, 0.51006085, 0.47130567, 0.5477834, 0.50898117, 0.45690927, 0.47369462, 0.39644894, 0.5584391, 0.57238275, 0.54340166, 0.60732967, 0.48326418, 0.5093681, 0.5761427, 0.5089658, 0.5254299, 0.576611, 0.64575636, 0.5780432, 0.5725407, 0.5947149, 0.6388848, 0.48266277, 0.48702016, 0.690388, 0.5787393, 0.5912061, 0.6040229, 0.6323904, 0.60075325, 0.62174606, 0.68606573, 0.613931, 0.6301447, 0.60302705, 0.63379574, 0.55229264, 0.5789316, 0.6381875, 0.55305034, 0.52948976, 0.6061244, 0.64543074, 0.7135358, 0.6275668, 0.5860295, 0.61008877, 0.54773134, 0.67304295, 0.7263142, 0.6855513, 0.6916308, 0.58557373, 0.66846436, 0.687311, 0.71426314, 0.6482736, 0.6457888]
history_GS_s5 = history_GS_s5[:len(x_GS_avg)]

# ema
ema_GS_s5 = [0.5620124, 0.5620123744010926, 0.5553982734680176, 0.5417512905597688, 0.5344994472265244, 0.5231890654683115, 0.5102829434978964, 0.4990343599177601, 0.48651766914044636, 0.47395067934317725, 0.4649697082411349, 0.45652509664038726, 0.4455280834544293, 0.44006144709365896, 0.4369136873511434, 0.43059464248668794, 0.4231412257491199, 0.4197635155086501, 0.41077529202384805, 0.40759485790565364, 0.40337475087733343, 0.40024226558051657, 0.3984653471574976, 0.39840155410758804, 0.4014396926879181, 0.3985980654763544, 0.4059349720186619, 0.41614088039159436, 0.42080781716608695, 0.42643532328459943, 0.4266339317499399, 0.43098896225143674, 0.43782681059702516, 0.44350495188114897, 0.44271831436763276, 0.44913414767810766, 0.45251501188959836, 0.45444549846308974, 0.4599423503368278, 0.4670662607689958, 0.4734711878842349, 0.4705863446008774, 0.47453379482134694, 0.4742109821746157, 0.48156822143579187, 0.4843095161192238, 0.48156949141674815, 0.4807820045267366, 0.47234869807793106, 0.4809577358648187, 0.49010023709103523, 0.4954303792354321, 0.5066203079733421, 0.5042846949797722, 0.5047930376441944, 0.5119280067126454, 0.5116317850685568, 0.5130115970077919, 0.5193715355488187, 0.5320100183808081, 0.5366133387854641, 0.5402060749504816, 0.5456569554543957, 0.55497973818807, 0.547748041086449, 0.5416752534506206, 0.5565465304908888, 0.5587658059887054, 0.5620098327659334, 0.5662111415025085, 0.5728290653428277, 0.5756214835823333, 0.5802339415473422, 0.590817120735885, 0.5931285086855662, 0.5968301293479239, 0.5974498209858091, 0.6010844127092497, 0.5962052359360818, 0.5944778753082481, 0.5988488405430789, 0.5942689904109664, 0.587791066932919, 0.5896244003488801, 0.5952050346834226, 0.6070381097825852, 0.6090909802465875, 0.6067848351790821, 0.6071152282232924, 0.6011768393941119, 0.6083634507561381, 0.6201585243855109, 0.6266978005213311, 0.6331910985388849, 0.62842936197029, 0.6324328620353917, 0.6379206751989943, 0.6455549217946192, 0.645826788337844, 0.6458229883836067]
ema_GS_s5 = ema_GS_s5[:len(x_GS_avg)]

# x
# [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360]
x_GS_s5 = x_GS_avg

# # seed 6
history_GS_s6 = [0.6787237, 0.5063529, 0.4269844, 0.40341026, 0.42057976, 0.36643517, 0.41364452, 0.36298066, 0.36684567, 0.3668321, 0.35549328, 0.39205068, 0.34217206, 0.38733885, 0.35354748, 0.34156442, 0.40983176, 0.4300274, 0.40825698, 0.41750118, 0.448204, 0.397657, 0.40279514, 0.34834608, 0.38477415, 0.40702292, 0.36764202, 0.37727815, 0.39131352, 0.38824838, 0.37612936, 0.39790183, 0.4050273, 0.37267685, 0.35167795, 0.37031063, 0.37340304, 0.35560316, 0.3700407, 0.3962702, 0.36418647, 0.37661156, 0.4001828, 0.38998657, 0.43004045, 0.39081833, 0.44759473, 0.36453918, 0.3743372, 0.39597204, 0.31477246, 0.41149673, 0.38360295, 0.35438383, 0.420393, 0.42238212, 0.3358668, 0.3524457, 0.43241522, 0.39490166, 0.33510724, 0.50230545, 0.4184793, 0.46555653, 0.41875926, 0.46785975, 0.45458117, 0.41684434, 0.4018939, 0.45642623, 0.43971196, 0.4878579, 0.4062504, 0.54661846, 0.4724536, 0.5664202, 0.5643031, 0.5548997, 0.5601997, 0.6516711, 0.5971519, 0.6874799, 0.699874, 0.704085, 0.5716546, 0.66548234, 0.6864393, 0.6504152, 0.69082546, 0.70865595, 0.7222992, 0.71974325, 0.70045006, 0.6790433, 0.69492847, 0.6725708, 0.73139, 0.7392173, 0.6520648]
history_GS_s6 = history_GS_s6[:len(x_GS_avg)]

# ema
ema_GS_s6 = [0.6787237, 0.6787236928939819, 0.6614866137504577, 0.6380363923311233, 0.6145737786889076, 0.5951743769466877, 0.5723004562693834, 0.5564348628852963, 0.5370894429744064, 0.5200650654131871, 0.504741769602421, 0.4898169203733114, 0.48004029668581855, 0.46625347266089057, 0.4583620100869936, 0.4478805574465575, 0.4372489433904394, 0.43450722528277974, 0.43405924230318493, 0.4314790158525219, 0.4300812324036757, 0.43189351023581024, 0.4284698599101281, 0.4259023875166037, 0.41814675720057415, 0.41480949632693703, 0.4140308390173558, 0.4093919566374937, 0.4061805758865404, 0.40469387060329864, 0.40304932194285586, 0.4003573256492584, 0.40011177639007295, 0.40060332876300564, 0.3978106808232285, 0.39319740816059867, 0.39090873078200067, 0.3891581619592861, 0.3858026616107543, 0.38422646692375423, 0.38543083880227874, 0.38330640149607126, 0.38263691740477557, 0.3843915070048971, 0.3849510137693885, 0.38945995728285343, 0.38959579432110103, 0.3953956880936037, 0.39231003690680954, 0.39051275285113835, 0.3910586818936078, 0.38343005939268543, 0.3862367263192845, 0.38597334838702496, 0.38281439617390234, 0.3865722555677426, 0.39015324164274323, 0.38472459836759854, 0.38149670771323463, 0.386588558658029, 0.3874198690987218, 0.38218860589890974, 0.3942002901145455, 0.3966281904615733, 0.40352102462987066, 0.405044847827017, 0.4113263375468788, 0.41565182091960945, 0.415771072645512, 0.4143833567555488, 0.4185876443853147, 0.42070007576377694, 0.42741585898844753, 0.4252993118326219, 0.4374312268102484, 0.44093346354999996, 0.4534821369436877, 0.464564233260229, 0.47359777918774615, 0.4822579690633899, 0.4991992833154219, 0.5089945425334708, 0.5268430796035948, 0.5441461700292369, 0.5601400522671885, 0.5612915088191105, 0.5717105921615189, 0.5831834605195247, 0.5899066326789371, 0.5999985156451743, 0.6108642594213857, 0.6220077552970267, 0.6317813049473778, 0.638648180727817, 0.6426876919549621, 0.6479117694868372, 0.6503776750004642, 0.6584789074393826, 0.6665527448295997, 0.6651039503728848]
ema_GS_s6 = ema_GS_s6[:len(x_GS_avg)]

# x
# [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360]
x_GS_s6 = x_GS_avg


## for std graphs

# y (ema) average
list_of_GS_ys = [ema_GS_s1[:len(history_GS_s1)], ema_GS_s2[:len(history_GS_s2)], ema_GS_s3[:len(history_GS_s3)]]
list_of_GS_ys_avg = [history_GS_s1, history_GS_s2, history_GS_s3, history_GS_s4, history_GS_s5, history_GS_s6]
y_GS_avg = [sum(sub_list) / len(sub_list) for sub_list in zip(*list_of_GS_ys_avg)]

# y_std
y_GS_std = np.mean([np.std(sub_list) for sub_list in zip(*list_of_GS_ys_avg)])





# function to plot with standard deviations
def plot_with_std(ax, x, y, y_std, label, ls, **kwargs):
    line, = ax.plot(x, y, label=label, ls=ls,**kwargs)
    alpha = 1
    ax.fill_between(x, y-y_std, y+y_std, color=line.get_color(), alpha=alpha*0.5)
    between, = ax.fill(np.NaN, np.NaN, color=line.get_color(), alpha=alpha*0.5)
    return (between, line)


#ESGD
x_ESGD = x_ESGD15_avg
y_EGSD = y_ESGD15_avg
y_std_ESGD = y_ESGD15_std

# PD
x_PD = x_PD_115_avg
y_PD = y_PD_115_avg
y_std_PD = y_PD_115_std

#KT RandomSearch
x_KT = x_KT_avg
y_KT = y_KT_avg
y_std_KT = y_KT_std

#sklHO
x_sklHO = x_sklHO_avg
y_sklHO = y_sklHO_avg
y_std_sklHO = y_sklHO_std

#GS
x_GS = x_GS_avg
y_GS = y_GS_avg
y_std_GS = y_GS_std

# KT Scheduling
x_KT_schedules = x_KT_schedules_avg
y_KT_schedules = y_KT_schedules_avg
y_std_KT_schedules = y_KT_schedules_std


fig, ax = plt.subplots()
fig.set_figheight(2.75)

# plotting with std
plot_with_std(ax, x_GS, y_GS, y_std_GS, "Grid Search", ls='--')
plot_with_std(ax, x_ESGD, y_EGSD, y_std_ESGD, "ESGD", '-.')
plot_with_std(ax, x_PD, y_PD, y_std_PD, "Population Descent", ls='-', color='red')

plot_with_std(ax, x_sklHO, y_sklHO, y_std_sklHO, "Sklearn Hyperopt", ls=':')
plot_with_std(ax, x_KT, y_KT, y_std_KT, "KT RandomSearch", ls=':')
plot_with_std(ax, x_KT_schedules, y_KT_schedules, y_std_KT_schedules, "KT Scheduling", ls=':')


# ax.plot(x_ESGD15, ema_ESGD15[:len(history_ESGD15)], ls=':', label = "ESGD")
# ax.plot(x_PD115_nr, ema_PD115_nr[:len(history_PD115_nr)], label = "Population Descent")
# # ax.plot(x_PD, ema_PD[:len(history_PD)], label = "Population Descent")
# ax.plot(x_GS, ema_GS[:len(history_GS)], ls='--', label = "Grid Search")
# ax.plot(x_KT, ema_KT, ls='-.', label = "KT RandomSearch")

# labels
# plt.title("FMNIST Val Loss Progress")
plt.xlabel("Gradient Steps")
plt.ylabel("Validation Loss")
plt.tight_layout()

# legend
leg = ax.legend();

def save_image(filename):
	p = PdfPages(filename)
	fig = plt.figure(1)
	fig.savefig(p, format='pdf') 
	p.close()

filename = "FMNIST_progress_ICLR24.pdf"
save_image(filename)


plt.show()







def graph_history(history):
	integers = [i for i in range(1, (len(history))+1)]

	ema = []
	avg = history[0]

	ema.append(avg)

	for loss in history:
		avg = (avg * 0.9) + (0.1 * loss)
		ema.append(avg)


	x = [j * 938 for j in integers]
	y = history

	# plot line
	plt.plot(x, ema[:len(history)])
	# plot title/captions
	plt.title("FMNIST Val Loss")
	plt.xlabel("Gradient Steps")
	plt.ylabel("Validation Loss")
	plt.tight_layout()


	print("ema:"), print(ema), print("")
	print("x:"), print(x), print("")
	print("history:"), print(history), print("")


	
	# plt.savefig("TEST_DATA/PD_trial_%s.png" % trial)
	def save_image(filename):
	    p = PdfPages(filename)
	    fig = plt.figure(1)
	    fig.savefig(p, format='pdf') 
	    p.close()

	filename = "FMNIST_progress_with_reg_model4_line.pdf"
	save_image(filename)

	# plot points too
	plt.scatter(x, history, s=20)

	filename = "FMNIST_progress_with_reg_model4_with_points.pdf"
	save_image(filename)


	plt.show(block=True), plt.close()
	plt.close('all')




## EXTRA DATA

# ### These PDs are all with regularization
# ## PD 50
# ema_PD = [0.5350429, 0.5350428819656372, 0.5334884405136109, 0.5248474431037903, 0.5088954495191574, 0.4931205833077431, 0.4807713917601109, 0.4708060048557521, 0.46552393935953384, 0.4488681057348979, 0.4306114076902091, 0.41745608383383925, 0.4070136010703436, 0.3986312502673559, 0.39135356432658075, 0.38401919024999415, 0.3737821646137429, 0.36554510899812515, 0.35732613064435603, 0.34912193171013134, 0.34501218812312545, 0.3411861331759023, 0.3356953118590827, 0.33409125396743256, 0.3282917480689422, 0.32394734987814444, 0.3198931840288569, 0.3150535965467629, 0.31054607133613266, 0.31234867662679766, 0.3104503001912679, 0.30816842730142885, 0.30422361447183677, 0.299455950442866, 0.30066174249403077, 0.29788356107967257, 0.2998127318843945, 0.29406470454556444, 0.2939940398647431, 0.2904959594351688, 0.28449526951992266, 0.2793391289676763, 0.27594864896227755, 0.27995423255523894, 0.28241053323293497, 0.27717322051833365, 0.2757088447240915, 0.2692649413312608, 0.26303551189587715, 0.2610085853262502, 0.2549896685770534]
# x_PD = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000]
# history_PD = [0.5350429, 0.51949847, 0.44707847, 0.3653275, 0.3511468, 0.36962867, 0.38111752, 0.41798535, 0.2989656, 0.26630113, 0.29905817, 0.31303126, 0.3231901, 0.3258544, 0.31800982, 0.28164893, 0.2914116, 0.28335533, 0.27528414, 0.3080245, 0.30675164, 0.28627792, 0.31965473, 0.2760962, 0.28484777, 0.2834057, 0.2714973, 0.26997834, 0.32857212, 0.2933649, 0.28763157, 0.2687203, 0.25654697, 0.31151387, 0.27287993, 0.31717527, 0.24233246, 0.29335806, 0.25901324, 0.23048906, 0.23293386, 0.24543433, 0.31600448, 0.30451724, 0.2300374, 0.26252946, 0.21126981, 0.20697065, 0.24276625, 0.20081942]

# ## PD 65
# ema_PD65 = [0.5350429, 0.5350428819656372, 0.5334884405136109, 0.5248474431037903, 0.5088954495191574, 0.4931205833077431, 0.4807713917601109, 0.4708060048557521, 0.46552393935953384, 0.4488681057348979, 0.4306114076902091, 0.41745608383383925, 0.4070136010703436, 0.3986312502673559, 0.39135356432658075, 0.38401919024999415, 0.3737821646137429, 0.36554510899812515, 0.35732613064435603, 0.34912193171013134, 0.34501218812312545, 0.3411861331759023, 0.3356953118590827, 0.33409125396743256, 0.3282917480689422, 0.32394734987814444, 0.3198931840288569, 0.3150535965467629, 0.31054607133613266, 0.31234867662679766, 0.3104503001912679, 0.30816842730142885, 0.30422361447183677, 0.299455950442866, 0.30066174249403077, 0.29788356107967257, 0.2998127318843945, 0.29406470454556444, 0.2939940398647431, 0.2904959594351688, 0.28449526951992266, 0.2793391289676763, 0.27594864896227755, 0.27995423255523894, 0.28241053323293497, 0.27717322051833365, 0.2757088447240915, 0.2692649413312608, 0.26303551189587715, 0.2610085853262502, 0.25758154824290497, 0.2539770808957263, 0.255530691785417, 0.25712801215899167, 0.2529643985437051, 0.25172596539318826, 0.2541830214732313, 0.25834370012939784, 0.2583099546062423, 0.258226383509708, 0.25345056097132496, 0.2507063970603573, 0.24973158320528516, 0.2489560778207384, 0.24398495870233797, 0.24770271883071562]
# x_PD65 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600]
# history_PD65 = [0.5350429, 0.51949847, 0.44707847, 0.3653275, 0.3511468, 0.36962867, 0.38111752, 0.41798535, 0.2989656, 0.26630113, 0.29905817, 0.31303126, 0.3231901, 0.3258544, 0.31800982, 0.28164893, 0.2914116, 0.28335533, 0.27528414, 0.3080245, 0.30675164, 0.28627792, 0.31965473, 0.2760962, 0.28484777, 0.2834057, 0.2714973, 0.26997834, 0.32857212, 0.2933649, 0.28763157, 0.2687203, 0.25654697, 0.31151387, 0.27287993, 0.31717527, 0.24233246, 0.29335806, 0.25901324, 0.23048906, 0.23293386, 0.24543433, 0.31600448, 0.30451724, 0.2300374, 0.26252946, 0.21126981, 0.20697065, 0.24276625, 0.22673821, 0.22153687, 0.2695132, 0.2715039, 0.21549188, 0.24058007, 0.27629653, 0.2957898, 0.25800624, 0.25747424, 0.21046816, 0.22600892, 0.24095826, 0.24197653, 0.19924489, 0.28116256]

# ##PD 90
# ema_PD90 = [0.5350429, 0.5350428819656372, 0.5334884405136109, 0.5248474431037903, 0.5088954495191574, 0.4931205833077431, 0.4807713917601109, 0.4708060048557521, 0.46552393935953384, 0.4488681057348979, 0.4306114076902091, 0.41745608383383925, 0.4070136010703436, 0.3986312502673559, 0.39135356432658075, 0.38401919024999415, 0.3737821646137429, 0.36554510899812515, 0.35732613064435603, 0.34912193171013134, 0.34501218812312545, 0.3411861331759023, 0.3356953118590827, 0.33409125396743256, 0.3282917480689422, 0.32394734987814444, 0.3198931840288569, 0.3150535965467629, 0.31054607133613266, 0.31234867662679766, 0.3104503001912679, 0.30816842730142885, 0.30422361447183677, 0.299455950442866, 0.30066174249403077, 0.29788356107967257, 0.2998127318843945, 0.29406470454556444, 0.2939940398647431, 0.2904959594351688, 0.28449526951992266, 0.2793391289676763, 0.27594864896227755, 0.27995423255523894, 0.28241053323293497, 0.27717322051833365, 0.2757088447240915, 0.2692649413312608, 0.26303551189587715, 0.2610085853262502, 0.25758154824290497, 0.2539770808957263, 0.255530691785417, 0.25712801215899167, 0.2529643985437051, 0.25172596539318826, 0.2541830214732313, 0.25834370012939784, 0.2583099546062423, 0.258226383509708, 0.25345056097132496, 0.2507063970603573, 0.24973158320528516, 0.2489560778207384, 0.24398495870233797, 0.24523666307986877, 0.2464710248022774, 0.24757157616402203, 0.24375806021021748, 0.246408487266245, 0.25289448044235335, 0.25585468061150457, 0.2502087260548593, 0.2519723181662847, 0.2510646570984622, 0.24735875778771343, 0.24462183135786864, 0.24305323050653233, 0.24351380723329152, 0.24625706187735585, 0.24734398882255484, 0.24653545463680204, 0.24611626217900792, 0.24936908319716825, 0.24424766154699185, 0.2422968579972922, 0.24296794685528927, 0.23982078748470176, 0.23882868365221288, 0.24057649203336, 0.23968470807250525]
# x_PD90 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600]
# history_PD90 = [0.5350429, 0.51949847, 0.44707847, 0.3653275, 0.3511468, 0.36962867, 0.38111752, 0.41798535, 0.2989656, 0.26630113, 0.29905817, 0.31303126, 0.3231901, 0.3258544, 0.31800982, 0.28164893, 0.2914116, 0.28335533, 0.27528414, 0.3080245, 0.30675164, 0.28627792, 0.31965473, 0.2760962, 0.28484777, 0.2834057, 0.2714973, 0.26997834, 0.32857212, 0.2933649, 0.28763157, 0.2687203, 0.25654697, 0.31151387, 0.27287993, 0.31717527, 0.24233246, 0.29335806, 0.25901324, 0.23048906, 0.23293386, 0.24543433, 0.31600448, 0.30451724, 0.2300374, 0.26252946, 0.21126981, 0.20697065, 0.24276625, 0.22673821, 0.22153687, 0.2695132, 0.2715039, 0.21549188, 0.24058007, 0.27629653, 0.2957898, 0.25800624, 0.25747424, 0.21046816, 0.22600892, 0.24095826, 0.24197653, 0.19924489, 0.256502, 0.25758028, 0.25747654, 0.20943642, 0.27026233, 0.31126842, 0.28249648, 0.19939514, 0.26784465, 0.24289571, 0.21400566, 0.2199895, 0.22893582, 0.247659, 0.27094635, 0.25712633, 0.23925865, 0.24234353, 0.27864447, 0.19815487, 0.22473963, 0.24900775, 0.21149635, 0.22989975, 0.25630677, 0.23165865]

# ema_PD115 = [0.5350429, 0.5350428819656372, 0.5334884405136109, 0.5248474431037903, 0.5088954495191574, 0.4931205833077431, 0.4807713917601109, 0.4708060048557521, 0.46552393935953384, 0.4488681057348979, 0.4306114076902091, 0.41745608383383925, 0.4070136010703436, 0.3986312502673559, 0.39135356432658075, 0.38401919024999415, 0.3737821646137429, 0.36554510899812515, 0.35732613064435603, 0.34912193171013134, 0.34501218812312545, 0.3411861331759023, 0.3356953118590827, 0.33409125396743256, 0.3282917480689422, 0.32394734987814444, 0.3198931840288569, 0.3150535965467629, 0.31054607133613266, 0.31234867662679766, 0.3104503001912679, 0.30816842730142885, 0.30422361447183677, 0.299455950442866, 0.30066174249403077, 0.29788356107967257, 0.2998127318843945, 0.29406470454556444, 0.2939940398647431, 0.2904959594351688, 0.28449526951992266, 0.2793391289676763, 0.27594864896227755, 0.27995423255523894, 0.28241053323293497, 0.27717322051833365, 0.2757088447240915, 0.2692649413312608, 0.26303551189587715, 0.2610085853262502, 0.25758154824290497, 0.2539770808957263, 0.255530691785417, 0.25712801215899167, 0.2529643985437051, 0.25172596539318826, 0.2541830214732313, 0.25834370012939784, 0.2583099546062423, 0.258226383509708, 0.25345056097132496, 0.2507063970603573, 0.24973158320528516, 0.2489560778207384, 0.24398495870233797, 0.24523666307986877, 0.2464710248022774, 0.24757157616402203, 0.24375806021021748, 0.246408487266245, 0.25289448044235335, 0.25585468061150457, 0.2502087260548593, 0.2519723181662847, 0.2510646570984622, 0.24735875778771343, 0.24462183135786864, 0.24305323050653233, 0.24351380723329152, 0.24625706187735585, 0.24734398882255484, 0.24653545463680204, 0.24611626217900792, 0.24936908319716825, 0.24424766154699185, 0.2422968579972922, 0.24296794685528927, 0.23982078748470176, 0.23882868365221288, 0.24057649203336, 0.24338062669213797, 0.24159170745649505, 0.2452235599652401, 0.24435601356287046, 0.2494132344960503, 0.24803203419202555, 0.24772840954679837, 0.2456880559130185, 0.24486578401359976, 0.24372205790668483, 0.248238012106327, 0.2511196418801914, 0.2562253073632691, 0.25025442353904015, 0.24999537121075185, 0.2497164835108917, 0.2534648564076663, 0.25757465838935145, 0.2532048768956617, 0.24950225029818612, 0.24842513985424397, 0.24610928345014893, 0.24025482071897605, 0.23873455792779819, 0.24079073789818672, 0.24363810112866988]
# x_PD115 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360, 64000, 64640, 65280, 65920, 66560, 67200, 67840, 68480, 69120, 69760, 70400, 71040, 71680, 72320, 72960, 73600]
# history_PD115 = [0.5350429, 0.51949847, 0.44707847, 0.3653275, 0.3511468, 0.36962867, 0.38111752, 0.41798535, 0.2989656, 0.26630113, 0.29905817, 0.31303126, 0.3231901, 0.3258544, 0.31800982, 0.28164893, 0.2914116, 0.28335533, 0.27528414, 0.3080245, 0.30675164, 0.28627792, 0.31965473, 0.2760962, 0.28484777, 0.2834057, 0.2714973, 0.26997834, 0.32857212, 0.2933649, 0.28763157, 0.2687203, 0.25654697, 0.31151387, 0.27287993, 0.31717527, 0.24233246, 0.29335806, 0.25901324, 0.23048906, 0.23293386, 0.24543433, 0.31600448, 0.30451724, 0.2300374, 0.26252946, 0.21126981, 0.20697065, 0.24276625, 0.22673821, 0.22153687, 0.2695132, 0.2715039, 0.21549188, 0.24058007, 0.27629653, 0.2957898, 0.25800624, 0.25747424, 0.21046816, 0.22600892, 0.24095826, 0.24197653, 0.19924489, 0.256502, 0.25758028, 0.25747654, 0.20943642, 0.27026233, 0.31126842, 0.28249648, 0.19939514, 0.26784465, 0.24289571, 0.21400566, 0.2199895, 0.22893582, 0.247659, 0.27094635, 0.25712633, 0.23925865, 0.24234353, 0.27864447, 0.19815487, 0.22473963, 0.24900775, 0.21149635, 0.22989975, 0.25630677, 0.26861784, 0.22549143, 0.27791023, 0.2365481, 0.29492822, 0.23560123, 0.24499579, 0.22732487, 0.23746534, 0.23342852, 0.2888816, 0.2770543, 0.3021763, 0.19651647, 0.2476639, 0.2472065, 0.2872002, 0.29456288, 0.21387684, 0.21617861, 0.23873115, 0.22526658, 0.18756466, 0.2250522, 0.25929636, 0.26926437]


# ## Grid Search with Reg
# ema_GS_reg = [0.5646509, 0.5646508932113647, 0.5579137057065964, 0.5419458642601966, 0.5295922215282917, 0.514656521871686, 0.5008631032660603, 0.4896589739878475, 0.4752416780972033, 0.460153913919647, 0.44705350377367686, 0.43913057307785824, 0.4348314123784251, 0.430309487947948, 0.42392752489667584, 0.4132362477888595, 0.41101954933195683, 0.4025619347946886, 0.3965393948605994, 0.39183915985089596, 0.38538722693141153, 0.3871319070388304, 0.37719305827582716, 0.3740695489141182, 0.3748653059625181, 0.37619058717103776, 0.37536566938887816, 0.36802879708347425, 0.36399144891504387, 0.3619825777137632, 0.35801140398302866, 0.3579028898225951, 0.35734103504539083, 0.3543623034690668, 0.3595311413289472, 0.3608973446561126, 0.3600635012751724, 0.36042285091572157, 0.3583863359113916, 0.355823577769433, 0.35119965195164193, 0.35097636448894537, 0.34770003557999074, 0.3436643266749305, 0.33996383703398014, 0.33454473933560225, 0.3332426856844059, 0.33084995247916266, 0.3332663479268183, 0.33418374980863597]
# x_GS_reg = [3200, 6400, 9600, 12800, 16000, 19200, 22400, 25600, 28800, 32000, 35200, 38400, 41600, 44800, 48000, 51200, 54400, 57600, 60800, 64000, 67200, 70400, 73600, 76800, 80000, 83200, 86400, 89600, 92800, 96000, 99200, 102400, 105600, 108800, 112000, 115200, 118400, 121600, 124800, 128000, 131200, 134400, 137600, 140800, 144000, 147200, 150400, 153600, 156800]
# history_GS_reg = [0.5646509, 0.49727902, 0.3982353, 0.41840944, 0.38023522, 0.37672234, 0.3888218, 0.34548602, 0.32436404, 0.3291498, 0.3678242, 0.39613897, 0.38961217, 0.36648986, 0.31701475, 0.39106926, 0.3264434, 0.34233654, 0.34953704, 0.32731983, 0.40283403, 0.28774342, 0.34595796, 0.38202712, 0.38811812, 0.3679414, 0.30199695, 0.32765532, 0.34390274, 0.32227084, 0.35692626, 0.35228434, 0.32755372, 0.40605068, 0.37319317, 0.3525589, 0.363657, 0.3400577, 0.33275875, 0.30958432, 0.34896678, 0.31821308, 0.30734295, 0.30665943, 0.28577286, 0.3215242, 0.30931535, 0.3550139, 0.34244037]

# ema_GS = [0.60191965, 0.6019196510314941, 0.5915467321872712, 0.5712674301862717, 0.5589803047776222, 0.5436787326157093, 0.5288852857667208, 0.5174447304413915, 0.5004676675563634, 0.48620679042627635, 0.47264857347509465, 0.4642135404560077, 0.4610054585051335, 0.4530209832827864, 0.4479056060410098, 0.4366634631243249, 0.4339177051860303, 0.4281948482702562, 0.42155918559822936, 0.41697893215471654, 0.411047941505201, 0.4157004738384074, 0.408908163118385, 0.4075549941730703, 0.40713736428071906, 0.40840760481282934, 0.41258012007407724, 0.4086886800891076, 0.40386966981583067, 0.40284506784164814, 0.397644525524532, 0.3997034839599328, 0.3979798208304343, 0.39570748066557326, 0.3979234092442949, 0.39860503909070133, 0.399350673291792, 0.4020585063103225, 0.3990703144374537, 0.40103644299832414, 0.39665767700964893, 0.39764911667848846, 0.39825933339904446, 0.393530674243367, 0.3981739319542613, 0.3947912517648548, 0.3966713097806224, 0.39366299037177405, 0.3988130699757252, 0.4022170464244646]
# x_GS = [3200, 6400, 9600, 12800, 16000, 19200, 22400, 25600, 28800, 32000, 35200, 38400, 41600, 44800, 48000, 51200, 54400, 57600, 60800, 64000, 67200, 70400, 73600, 76800, 80000, 83200, 86400, 89600, 92800, 96000, 99200, 102400, 105600, 108800, 112000, 115200, 118400, 121600, 124800, 128000, 131200, 134400, 137600, 140800, 144000, 147200, 150400, 153600, 156800]
# x_GS = [i / 5 for i in x_GS]
# history_GS = [0.60191965, 0.49819046, 0.3887537, 0.44839618, 0.40596458, 0.39574426, 0.41447973, 0.3476741, 0.3578589, 0.35062462, 0.38829824, 0.43213272, 0.3811607, 0.4018672, 0.33548418, 0.40920588, 0.37668914, 0.36183822, 0.37575665, 0.35766903, 0.45757326, 0.34777737, 0.39537647, 0.4033787, 0.41983977, 0.45013276, 0.37366572, 0.36049858, 0.39362365, 0.35083964, 0.4182341, 0.38246685, 0.37525642, 0.41786677, 0.4047397, 0.40606138, 0.426429, 0.3721766, 0.4187316, 0.35724878, 0.40657207, 0.40375128, 0.35097274, 0.43996325, 0.36434713, 0.41359183, 0.36658812, 0.4451638, 0.43285283]


















